<!DOCTYPE html><html><head>
      <title>SAS Programmer 101</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\Dux1\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.15\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="sas-programmer-101">SAS-Programmer-101 </h1>
<div class="code-chunk" data-id="code-chunk-id-0" data-cmd="toc"><div class="input-div"><div class="code-chunk-btn-group"><div class="run-btn btn btn-xs btn-primary"><span>▶︎</span></div><div class="run-all-btn btn btn-xs btn-primary">all</div></div><div class="status">running...</div></div><div class="output-div"></div></div><ul>
<li><a href="#sas-programmer-101">SAS-Programmer-101</a>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E9%80%89%E9%A1%B9%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F">数据集选项执行顺序</a></li>
<li><a href="#sas-eg%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E6%9F%A5log%E7%9A%84%E6%96%B9%E6%B3%95">SAS EG设置自动查log的方法</a></li>
<li><a href="#%E5%A4%84%E7%90%86%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E4%B8%8E%E8%BE%93%E5%87%BA%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7">处理特殊字符与输出特殊符号</a></li>
<li><a href="#%E6%9C%89%E7%94%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%E9%80%89%E9%A1%B9">有用的系统选项</a></li>
<li><a href="#sas%E6%95%B0%E6%8D%AE%E9%9B%86%E9%80%BB%E8%BE%91%E5%BA%93excel%E7%9A%84%E4%BA%A4%E4%BA%92">sas数据集/逻辑库/excel的交互</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E5%AE%8F%E5%8F%98%E9%87%8F%E7%9A%84%E9%A2%9D%E5%A4%96%E7%A9%BA%E6%A0%BC">删除宏变量的额外空格</a></li>
<li><a href="#%E6%8E%A9%E7%A0%81%E5%AE%8F%E5%87%BD%E6%95%B0">掩码宏函数</a></li>
<li><a href="#attrib%E8%AF%AD%E5%8F%A5"><code>attrib</code>语句</a></li>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">正则表达式</a></li>
<li><a href="#length%E8%AF%AD%E5%8F%A5"><code>length</code>语句</a></li>
<li><a href="#retain%E8%AF%AD%E5%8F%A5"><code>retain</code>语句</a></li>
<li><a href="#set%E8%AF%AD%E5%8F%A5"><code>set</code>语句</a></li>
<li><a href="#merge%E8%AF%AD%E5%8F%A5"><code>merge</code>语句</a></li>
<li><a href="#array%E8%AF%AD%E5%8F%A5"><code>array</code>语句</a></li>
<li><a href="#select-when%E8%AF%AD%E5%8F%A5"><code>select-when</code>语句</a></li>
<li><a href="#continue%E4%B8%8Eleave%E8%AF%AD%E5%8F%A5"><code>continue</code>与<code>leave</code>语句</a></li>
<li><a href="#link%E4%B8%8Egoto%E8%AF%AD%E5%8F%A5"><code>link</code>与<code>goto</code>语句</a></li>
<li><a href="#output%E4%B8%8Ereturn%E8%AF%AD%E5%8F%A5"><code>output</code>与<code>return</code>语句</a></li>
<li><a href="#proc-sort%E8%BF%87%E7%A8%8B"><code>proc sort</code>过程</a></li>
<li><a href="#proc-format%E8%BF%87%E7%A8%8B"><code>proc format</code>过程</a></li>
<li><a href="#proc-report%E8%BF%87%E7%A8%8B"><code>proc report</code>过程</a></li>
<li><a href="#proc-transpose%E8%BF%87%E7%A8%8B"><code>proc transpose</code>过程</a></li>
<li><a href="#proc-import%E8%BF%87%E7%A8%8B"><code>proc import</code>过程</a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="数据集选项执行顺序">数据集选项执行顺序 </h2>
<h3 id="选项执行顺序">选项执行顺序 </h3>
<ul>
<li>data步语句：
<ul>
<li><code>where</code>语句→其他执行语句→<code>keep</code>/<code>drop</code>语句→<code>rename</code>语句</li>
</ul>
</li>
<li>数据集选项：
<ul>
<li><code>keep</code>/<code>drop</code>选项→<code>rename</code>选项→<code>where</code>选项</li>
</ul>
</li>
</ul>
<h3 id="常见数据集选项">常见数据集选项 </h3>
<table>
<thead>
<tr>
<th>选项</th>
<th>可用值</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read=</code></td>
<td>字符串</td>
<td>设置读取数据集的秘密</td>
</tr>
<tr>
<td><code>write=</code></td>
<td>字符串</td>
<td>设置改写数据集的秘密</td>
</tr>
<tr>
<td><code>alter=</code></td>
<td>字符串</td>
<td>设置替换和删除数据集的秘密</td>
</tr>
<tr>
<td><code>pw=</code></td>
<td>字符串</td>
<td>设置<code>read</code>，<code>write</code>，<code>alter</code>的密码</td>
</tr>
<tr>
<td><code>compress=</code></td>
<td><code>YES</code>|<code>NO</code></td>
<td>是否压缩数据集</td>
</tr>
<tr>
<td><code>encrypt=</code></td>
<td><code>YES</code>|<code>NO</code></td>
<td>是否加密数据集</td>
</tr>
<tr>
<td><code>label=</code></td>
<td>字符串</td>
<td>指定数据集标签</td>
</tr>
<tr>
<td><code>replace=</code></td>
<td><code>YES</code>|<code>NO</code></td>
<td>是否允许被替代</td>
</tr>
<tr>
<td><code>repempty=</code></td>
<td><code>YES</code>|<code>NO</code></td>
<td>指定新的空数据集是否可以覆盖同名非空数据集</td>
</tr>
<tr>
<td><code>firstobs=</code></td>
<td>数值</td>
<td>指定第一条观测</td>
</tr>
<tr>
<td><code>obs=</code></td>
<td>数值</td>
<td>指定最后一条观测</td>
</tr>
<tr>
<td><code>where=</code></td>
<td>逻辑判断</td>
<td>指定数据筛选条件</td>
</tr>
<tr>
<td><code>in=</code></td>
<td>新变量</td>
<td>创建一个逻辑变量用来标识观测的来源</td>
</tr>
<tr>
<td><code>drop=</code></td>
<td>变量组</td>
<td>排除指定变量</td>
</tr>
<tr>
<td><code>keep=</code></td>
<td>变量组</td>
<td>保留指定变量</td>
</tr>
<tr>
<td><code>rename=</code></td>
<td><code>oldname=newname</code></td>
<td>变量重命名</td>
</tr>
</tbody>
</table>
<h2 id="sas-eg设置自动查log的方法">SAS EG设置自动查log的方法 </h2>
<ol>
<li>
<p>打开SAS EG的<code>tools</code>中的<code>options</code></p>
</li>
<li>
<p>选中<code>SAS Programs</code>中的Additional SAS Code，并勾选上下面两个选项：</p>
<blockquote>
<p>Insert custom SAS code before submitted code<br>
Insert custom SAS code after submitted code</p>
</blockquote>
</li>
<li>
<p>在<code>before</code>选项的<code>edit</code>中插入如下代码：</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token macro-declaration"><span class="token keyword keyword-%macro">%macro</span> egautoexec</span><span class="token punctuation">;</span>
    <span class="token macro-keyword keyword">%if</span> <span class="token string">"&amp;_SASPROGRAMFILE."</span> <span class="token operator-keyword operator">ne</span> <span class="token string">""</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%let</span> egfileref<span class="token operator">=</span><span class="token macro-keyword keyword">%SYSFUNC</span><span class="token punctuation">(</span><span class="token function keyword">REVERSE</span><span class="token punctuation">(</span>sas<span class="token punctuation">.</span>cexeotua<span class="token function keyword">%SUBSTR</span><span class="token punctuation">(</span> <span class="token macro-keyword keyword">%SYSFUNC</span><span class="token punctuation">(</span><span class="token function keyword">COMPRESS</span><span class="token punctuation">(</span><span class="token macro-keyword keyword">%SYSFUNC</span><span class="token punctuation">(</span><span class="token function keyword">TRANSLATE</span><span class="token punctuation">(</span><span class="token function keyword">%QUOTE</span><span class="token punctuation">(</span><span class="token macro-keyword keyword">%SYSFUNC</span><span class="token punctuation">(</span><span class="token function keyword">REVERSE</span><span class="token punctuation">(</span><span class="token macro-variable">&amp;_sasprogramfile</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function keyword">%EVAL</span><span class="token punctuation">(</span><span class="token macro-keyword keyword">%INDEX</span><span class="token punctuation">(</span><span class="token macro-keyword keyword">%SYSFUNC</span><span class="token punctuation">(</span><span class="token function keyword">REVERSE</span><span class="token punctuation">(</span><span class="token macro-variable">&amp;_sasprogramfile</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%if</span> <span class="token macro-keyword keyword">%sysfunc</span><span class="token punctuation">(</span><span class="token function keyword">fileexist</span><span class="token punctuation">(</span><span class="token macro-variable">&amp;egfileref</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token macro-keyword keyword">%if</span> <span class="token macro-keyword keyword">%symexist</span><span class="token punctuation">(</span>_project<span class="token punctuation">)</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
                <span class="token macro-keyword keyword">%if</span> <span class="token macro-variable">&amp;_project</span> <span class="token operator-keyword operator">ne</span> <span class="token macro-keyword keyword">%scan</span><span class="token punctuation">(</span><span class="token macro-variable">&amp;_sasprogramfile</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
                    <span class="token macro-keyword keyword">%INC</span> <span class="token string">"&amp;egfileref."</span><span class="token punctuation">;</span>
                <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
            <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
            <span class="token macro-keyword keyword">%else</span> <span class="token macro-keyword keyword">%INC</span> <span class="token string">"&amp;egfileref."</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>

        <span class="token macro-keyword keyword">%else</span> <span class="token macro-keyword keyword">%put</span> NOTE:<span class="token punctuation">[</span>PXL<span class="token punctuation">]</span> The <span class="token keyword keyword-file">file</span> <span class="token macro-variable">&amp;egfileref</span><span class="token punctuation">.</span> does <span class="token operator-keyword operator">not</span> exist<span class="token punctuation">.</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>

        <span class="token macro-keyword keyword">%else</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token macro-keyword keyword">%put</span> NOTE:<span class="token punctuation">[</span>PXL<span class="token punctuation">]</span> SAS code is <span class="token operator-keyword operator">not</span> saved on the server<span class="token punctuation">.</span> Study autoexec has <span class="token operator-keyword operator">not</span> been executed<span class="token punctuation">.</span><span class="token punctuation">;</span>
    <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
<span class="token macro-end"><span class="token keyword keyword-%mend">%mend</span> egautoexec</span><span class="token punctuation">;</span>
<span class="token punctuation">%</span>egautoexec<span class="token punctuation">;</span>

<span class="token keyword keyword-filename">filename</span> LogFile <span class="token keyword keyword-temp">temp</span><span class="token punctuation">;</span>
<span class="token step keyword">Proc printto</span> <span class="token proc-args"><span class="token arg keyword">log</span><span class="token operator">=</span><span class="token arg-value">LogFile</span> <span class="token arg keyword">new</span><span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>在<code>after</code>选项的<code>edit</code>中插入如下代码：</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token macro-declaration"><span class="token keyword keyword-%macro">%macro</span> egcheck(notechk=)</span><span class="token punctuation">;</span>
    <span class="token step keyword">proc printto</span> log<span class="token operator">=</span>log<span class="token punctuation">;</span>
    <span class="token step keyword">run</span><span class="token punctuation">;</span>
    <span class="token step keyword">data</span> <span class="token keyword keyword-_null_">_null_</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-infile">infile</span> logfile truncover lrecl<span class="token operator">=</span><span class="token number">30000</span><span class="token punctuation">;</span>
        input<span class="token punctuation">;</span>
        <span class="token keyword keyword-length">length</span> content <span class="token punctuation">$</span><span class="token number">30000</span><span class="token punctuation">;</span>
        content<span class="token operator">=</span>_infile_<span class="token punctuation">;</span>
        <span class="token comment">/* Change ERROR \d-\d to ERROR: */</span>
        content <span class="token operator">=</span> <span class="token function keyword">prxchange</span><span class="token punctuation">(</span><span class="token string">'s/ERROR( +\d+-\d+: +)/ERROR:\1/o'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/* Replace special notes with warning */</span>
        pattern <span class="token operator">=</span> <span class="token function keyword">prxparse</span><span class="token punctuation">(</span><span class="token string">"/(?&lt;=^(NOTE:|INFO:)) .*\b(&amp;notechk)\b/i"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token function keyword">prxmatch</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> content<span class="token punctuation">)</span> <span class="token keyword keyword-and">and</span> <span class="token operator">^</span><span class="token function keyword">index</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token string">"VARCHAR data type is not supported by the V9 engine."</span><span class="token punctuation">)</span> <span class="token keyword keyword-and">and</span> <span class="token operator">^</span><span class="token function keyword">index</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span><span class="token string">"Run the study autoexec or assign _PROJECT macro variable"</span><span class="token punctuation">)</span> <span class="token keyword keyword-then do">then do</span><span class="token punctuation">;</span>
            content <span class="token operator">=</span> <span class="token function keyword">prxchange</span><span class="token punctuation">(</span><span class="token string">'s/^(NOTE:|INFO:) /WARNING: /'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function keyword">strip</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
        <span class="token comment">/* output the log */</span>
        len<span class="token operator">=</span><span class="token function keyword">length</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        putlog content <span class="token punctuation">$</span>varying200<span class="token punctuation">.</span> len<span class="token punctuation">;</span>
    <span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token macro-end"><span class="token keyword keyword-%mend">%mend</span> egcheck</span><span class="token punctuation">;</span>

<span class="token function keyword">%egcheck</span><span class="token punctuation">(</span>notechk<span class="token operator">=</span>converted<span class="token operator">|</span>uninitialized<span class="token operator">|</span>invalid<span class="token operator">|</span>truncation<span class="token operator">|</span>missing values<span class="token operator">|</span>Invalid<span class="token operator">|</span>overwritten<span class="token operator">|</span>MERGE statement has more than one<span class="token punctuation">)</span>

<span class="token macro-keyword keyword">%let</span> GMPXLERR<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>保存退出即可。</p>
</li>
</ol>
<h2 id="处理特殊字符与输出特殊符号">处理特殊字符与输出特殊符号 </h2>
<h3 id="上下标supersub">上/下标：<code>super</code>/<code>sub</code> </h3>
<p>直接在字符串中替换使用<code>(ESC){super XXXXX}</code>,<code>(ESC){sub XXXXX}</code>即可：</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> rep1<span class="token punctuation">;</span>
    item <span class="token operator">=</span> <span class="token string">"S01001^{super *}"</span><span class="token punctuation">;</span>
    col1 <span class="token operator">=</span> <span class="token number">2.528</span><span class="token punctuation">;</span>
    col2 <span class="token operator">=</span> <span class="token number">163.725</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"^"</span><span class="token punctuation">;</span>
<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">rep</span><span class="token number">1</span> <span class="token arg keyword">nowindows</span> <span class="token arg keyword">headline</span> <span class="token arg keyword">headskip</span> <span class="token arg keyword">spacing</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-column">column</span> item col1<span class="token operator">-</span>col2<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> item <span class="token operator">/</span> display flow <span class="token string">" 受试者"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> col1 <span class="token operator">/</span> display flow <span class="token string">" T^{sub max}"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> col2 <span class="token operator">/</span> display flow <span class="token string">" C^{sub max}"</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="含特殊意义的字符raw">含特殊意义的字符：<code>raw</code> </h3>
<p><code>%</code>、<code>&amp;</code>、<code>^(转义字符)</code>等在SAS中有其特定的含义，直接显示在字符串中会出现异常。  可以使用<code>(ESC){raw XXXXX}</code>的语法。</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"^"</span><span class="token punctuation">;</span>
<span class="token macro-keyword keyword">%let</span> n1<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
<span class="token macro-keyword keyword">%let</span> n2<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>

<span class="token step keyword">data</span> rep1<span class="token punctuation">;</span>
    item <span class="token operator">=</span> <span class="token string">"S01001"</span><span class="token punctuation">;</span>
    col1 <span class="token operator">=</span> <span class="token number">0.81</span><span class="token punctuation">;</span>
    col2 <span class="token operator">=</span> <span class="token number">0.72</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">rep</span><span class="token number">1</span> <span class="token arg keyword">nowindows</span> <span class="token arg keyword">headline</span> <span class="token arg keyword">headskip</span> <span class="token arg keyword">spacing</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-column">column</span> item col1<span class="token operator">-</span>col2<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> item <span class="token operator">/</span> display flow <span class="token string">" 受试者"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> col1 <span class="token operator">/</span> display flow <span class="token string">" 受试制剂（0.05^{raw %}剂量） N=&amp;n1"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> col2 <span class="token operator">/</span> display flow <span class="token string">" 受试制剂（0.15^{raw %}剂量） N=&amp;n2"</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="其他特殊字符unicode">其他特殊字符：<code>unicode</code> </h3>
<p>在其他语法中可能使用<code>\u</code>前缀，在SAS中是用<code>(ESC){unicode XXXXX}</code>为前缀。</p>
<p>unicode速查：<a href="https://www.compart.com/en/unicode/" title="Unicode - Compart">Unicode - Compart</a>。常用的unicode编码：</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>Unicode</th>
</tr>
</thead>
<tbody>
<tr>
<td>≤</td>
<td>U+2264</td>
</tr>
<tr>
<td>≥</td>
<td>U+2265</td>
</tr>
<tr>
<td>换行符（Carriage Return）</td>
<td>U+0D</td>
</tr>
<tr>
<td>软回车符（End of Line）</td>
<td>U+0A</td>
</tr>
<tr>
<td>Form Feed</td>
<td>U+0C</td>
</tr>
<tr>
<td>制表符（Tab）</td>
<td>U+09</td>
</tr>
</tbody>
</table>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"^"</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> rep1<span class="token punctuation">;</span>
    <span class="token comment">/* 添加一个 &amp;（unicode 十六进制=26）*/</span>
    item<span class="token operator">=</span><span class="token string">"S01001^{unicode 26}S01002"</span><span class="token punctuation">;</span>
    col1 <span class="token operator">=</span> <span class="token number">2.528</span><span class="token punctuation">;</span>
    col2 <span class="token operator">=</span> <span class="token number">163.725</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">rep</span><span class="token number">1</span> <span class="token arg keyword">nowindows</span> <span class="token arg keyword">headline</span> <span class="token arg keyword">headskip</span> <span class="token arg keyword">spacing</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-column">column</span> item col1<span class="token operator">-</span>col2<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> item <span class="token operator">/</span> display flow <span class="token string">" 受试者"</span><span class="token punctuation">;</span>
    <span class="token comment">/* 可以嵌套使用：字母a（unicode 十六进制=61）*/</span>
    <span class="token keyword keyword-define">define</span> col1 <span class="token operator">/</span> display flow <span class="token string">" T^{sub m^{unicode 61}x}"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> col2 <span class="token operator">/</span> display flow <span class="token string">" C^{sub max}"</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h3 id="使用unicode删除特殊字符">使用unicode删除特殊字符 </h3>
<p>有时在导入外部数据文件时，可能在字符串中存在一些“不可见”的字符，比如换行符、制表符tab、软回车等等。可以使用unicode来删除：<code>compress(str,'0a'x)</code></p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> rep1<span class="token punctuation">;</span>
    <span class="token keyword keyword-length">length</span> type str <span class="token punctuation">$</span><span class="token number">200</span><span class="token punctuation">;</span>

    type <span class="token operator">=</span> <span class="token string">"无特殊字符"</span><span class="token punctuation">;</span>
    str  <span class="token operator">=</span> <span class="token string">"我是一名程序员"</span><span class="token punctuation">;</span>
    klength<span class="token operator">=</span><span class="token function keyword">klength</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>

    type <span class="token operator">=</span> <span class="token string">"包含特殊字符"</span><span class="token punctuation">;</span>
    <span class="token comment">/* 换行符的unicode，十进制=10，十六进制=0a */</span>
    str  <span class="token operator">=</span> <span class="token string">"我是一名程序员"</span><span class="token operator">||</span><span class="token function keyword">byte</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    klength<span class="token operator">=</span><span class="token function keyword">klength</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>

    type <span class="token operator">=</span> <span class="token string">"删除特殊字符"</span><span class="token punctuation">;</span>
    <span class="token comment">/* 换行符的unicode，十进制=10，十六进制=0a */</span>
    str  <span class="token operator">=</span> <span class="token function keyword">compress</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token numeric-constant number">'0a'x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    klength<span class="token operator">=</span><span class="token function keyword">klength</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
|type|str|klength|
|-|-|-|
|无特殊字符|我是一名程序员|7|
|包含特殊字符|我是一名程序员|8|
|删除特殊字符|我是一名程序员|7|
*/</span>
</code></pre><h2 id="有用的系统选项">有用的系统选项 </h2>
<h3 id="修改变量名命名规则">修改变量名命名规则 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-options">options</span><span class="token options-args"> <span class="token arg keyword">validvarname</span><span class="token operator">=</span><span class="token arg-value">v</span><span class="token number">7</span>|<span class="token arg keyword">any</span>|<span class="token arg keyword">upcase</span></span><span class="token punctuation">;</span>
</code></pre><ul>
<li>默认为<code>v7</code>：系统使用一般意义下的命名规则：下划线跟英文字母开头，英文字母、数字、下划线组成，且总长度不超过32个英文字符长度。</li>
<li><code>any</code>：表示可以使用特殊字符命名，包括中文命名。</li>
<li><code>upcase</code>：表示所有数据集中最终变量都采用大写。</li>
</ul>
<h3 id="宏里面使用in语句的系统选项">宏里面使用<code>in</code>语句的系统选项 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-options">options</span> minoperator<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>控制宏处理器是否识别和计算<code>IN</code>(<code>#</code>)逻辑运算符（在宏语言中<code>#</code>就代表<code>in</code>）。</li>
<li>需要注意列表需要以空格分隔，不能以逗号分隔，但是在DATA步中两种都可以。</li>
<li>但是我们自己可以指定分隔符，通过<code>options mindelimiter=',';</code>。如果需要恢复空格，直接<code>options mindelimiter='';</code>就可以了。</li>
</ul>
<h3 id="解决footnote太长的warning">解决footnote太长的warning </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-options">options</span><span class="token options-args"> <span class="token arg keyword">noquotelenmax</span></span><span class="token punctuation">;</span>
</code></pre><ul>
<li>这个选项可以规避因为footnote太长导致的log issue：
<blockquote>
<p>NOTE: The quoted string currently being processed has become more than 262 bytes long. You might have unbalanced quotation marks.</p>
</blockquote>
</li>
</ul>
<h2 id="sas数据集逻辑库excel的交互">sas数据集/逻辑库/excel的交互 </h2>
<h3 id="sas数据集导出到excel">sas数据集导出到excel </h3>
<h4 id="使用ods-excel">使用<code>ods excel</code> </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-ods">ods</span> listing <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> excel <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"./DS Compliance New Listing.xlsx"</span>
    <span class="token function keyword">options</span><span class="token punctuation">(</span>sheet_name<span class="token operator">=</span><span class="token string">"Listing"</span> frozen_headers<span class="token operator">=</span><span class="token string">"Yes"</span> autofilter<span class="token operator">=</span><span class="token string">"Yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token step keyword">proc report</span> <span class="token keyword keyword-data">data</span><span class="token operator">=</span>qc_dem<span class="token punctuation">.</span>l_adex_ae_sv001<span class="token punctuation">;</span>
        <span class="token keyword keyword-column">column</span> col:<span class="token punctuation">;</span>
    <span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> excel <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>

</code></pre><h4 id="使用ods-导出带有template的excel">使用<code>ods</code> 导出带有template的excel </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* output for EXCEL */</span>
<span class="token keyword keyword-ods">ods</span> listing <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> tagsets<span class="token punctuation">.</span>excelxp
    <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"&amp;_odsur.&amp;TFLNAME..xls"</span>
    style<span class="token operator">=</span>global<span class="token punctuation">.</span>rtf
    <span class="token function keyword">options</span><span class="token punctuation">(</span>EMBEDDED_TITLES       <span class="token operator">=</span> <span class="token string">"yes"</span>
            EMBEDDED_FOOTNOTES    <span class="token operator">=</span> <span class="token string">"yes"</span>
            EMBED_TITLES_ONCE     <span class="token operator">=</span> <span class="token string">"yes"</span>
            AUTOFIT_HEIGHT        <span class="token operator">=</span> <span class="token string">"yes"</span>
            ORIENTATION           <span class="token operator">=</span> <span class="token string">"landscape"</span>
            FROZEN_HEADERS        <span class="token operator">=</span> <span class="token string">"4"</span>
            CENTER_HORIZONTAL     <span class="token operator">=</span> <span class="token string">"yes"</span>
            AUTOFILTER            <span class="token operator">=</span> <span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> tagsets<span class="token punctuation">.</span>ExcelXP <span class="token function keyword">options</span><span class="token punctuation">(</span>sheet_name<span class="token operator">=</span><span class="token string">"&amp;TFLNAME."</span> ABSOLUTE_COLUMN_WIDTH <span class="token operator">=</span><span class="token string">"20."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"~"</span><span class="token punctuation">;</span>
<span class="token function keyword">%loadtf_dsur</span><span class="token punctuation">(</span>tabout<span class="token operator">=</span><span class="token macro-variable">&amp;TFLNAME</span><span class="token punctuation">.</span><span class="token punctuation">,</span> prg<span class="token operator">=</span><span class="token macro-variable">&amp;PGMNAME</span><span class="token punctuation">.</span><span class="token punctuation">,</span> filetype<span class="token operator">=</span>excel<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token step keyword">proc print</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">dsur.</span><span class="token macro-variable">&amp;TFLNAME</span><span class="token punctuation">.</span> <span class="token arg keyword">label</span> <span class="token arg keyword">noobs</span><span class="token punctuation">;</span></span>
        <span class="token keyword keyword-var">var</span>  COL:  <span class="token operator">/</span>  style <span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span>tagattr<span class="token operator">=</span><span class="token string">'format:@'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> tagsets<span class="token punctuation">.</span>excelxp <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> listing<span class="token punctuation">;</span>

</code></pre><p>注意：</p>
<ul>
<li>%loadtf_dsur为footnote相关的宏。</li>
<li>需要修改header中的页码，不需要显示。</li>
<li>导出的excel文件中会携带换行符，如果不需要对records进行换行需要额外处理。</li>
<li>如果需要导出BYVAR需要检查是否设置label。</li>
</ul>
<h4 id="使用proc-export">使用<code>proc export</code> </h4>
<h3 id="excel导入为sas数据集">excel导入为sas数据集 </h3>
<h4 id="使用proc-import">使用<code>proc import</code> </h4>
<h2 id="删除宏变量的额外空格">删除宏变量的额外空格 </h2>
<p>如果在sas中直接使用<code>proc sql into</code>语法生成的宏变量值，当输出的output中可能会遇到额外的空格。有以下几种解决方法。</p>
<h3 id="方法separated-by-">方法：<code>separated by ''</code> </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sql</span><span class="token punctuation">;</span><span class="token proc-sql">
<span class="token sql language-sql">    <span class="token keyword keyword-select">select</span> <span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword keyword-into">into</span> : pop separated <span class="token keyword keyword-by">by</span> <span class="token string">""</span> <span class="token keyword keyword-from">from</span> sashelp<span class="token punctuation">.</span>class<span class="token punctuation">;</span></span>
</span><span class="token step keyword">quit</span><span class="token punctuation">;</span>
</code></pre><h3 id="方法trimmed">方法：<code>trimmed</code> </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sql</span><span class="token punctuation">;</span><span class="token proc-sql">
<span class="token sql language-sql">    <span class="token keyword keyword-select">select</span> <span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword keyword-into">into</span> : pop trimmed <span class="token keyword keyword-from">from</span> sashelp<span class="token punctuation">.</span>class<span class="token punctuation">;</span></span>
</span><span class="token step keyword">quit</span><span class="token punctuation">;</span>

</code></pre><h3 id="方法let">方法：<code>%let</code> </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sql</span><span class="token punctuation">;</span><span class="token proc-sql">
<span class="token sql language-sql">    <span class="token keyword keyword-select">select</span> <span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword keyword-into">into</span> : pop <span class="token keyword keyword-from">from</span> sashelp<span class="token punctuation">.</span>class<span class="token punctuation">;</span></span>
</span><span class="token step keyword">quit</span><span class="token punctuation">;</span>
<span class="token macro-keyword keyword">%LET</span> pop<span class="token operator">=</span><span class="token macro-variable">&amp;pop</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><h2 id="掩码宏函数">掩码宏函数 </h2>
<p>Macro Quoting就是将具有特殊功能字符及字母组合的特殊功能隐藏掉。例如：让分号（<code>;</code>）不再表示一个语句的结束，而就是一个普普通通的字符；让<code>GE</code>不再表示大于等于的比较符，而就是两个普普通通的字母。</p>
<h3 id="str与nrstr"><code>%str</code>与<code>%nrstr</code> </h3>
<p>这两个函数都用来隐藏下面这些字符的特殊作用。如果在文本中出现不匹配的单引号、双引号、或者括号，则需要在其前面加一个<code>%</code>用来标注该符号是不匹配的字符。<code>%</code>的意义类似于其他语言中的转义字符：斜杠（<code>\</code>）</p>
<table>
<thead>
<tr>
<th>+</th>
<th>-</th>
<th>*</th>
<th>/</th>
<th>&lt;</th>
<th>&gt;</th>
<th>=</th>
</tr>
</thead>
<tbody>
<tr>
<td>﹁</td>
<td>^</td>
<td>~</td>
<td>;</td>
<td>,</td>
<td>#</td>
<td>blank</td>
</tr>
<tr>
<td>AND</td>
<td>OR</td>
<td>NOT</td>
<td>EQ</td>
<td>NE</td>
<td>LE</td>
<td>LT</td>
</tr>
<tr>
<td>GE</td>
<td>GT</td>
<td>IN</td>
<td>'</td>
<td>''</td>
<td>(</td>
<td>)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>%nr</code>前缀的掩码函数还能隐藏<code>%</code>和<code>&amp;</code>两个Macro Trigger的功能，使其跟普通字符一样。NR为Not Resolved的简写，即不解析宏变量和宏程序（有NR的掩码函数都是此意义）</p>
</blockquote>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> test<span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token string">"xxx%"</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token string">"xxx(%)"</span><span class="token punctuation">;</span>
z <span class="token operator">=</span> <span class="token string">"zzz(&amp;)"</span><span class="token punctuation">;</span>
z2 <span class="token operator">=</span> <span class="token macro-string-functions"><span class="token function keyword">%str</span><span class="token punctuation">(</span>"zzz<span class="token punctuation">(</span><span class="token escaped-char">%)</span>"<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
z3 <span class="token operator">=</span> <span class="token macro-string-functions"><span class="token function keyword">%nrstr</span><span class="token punctuation">(</span>"zzz<span class="token punctuation">(</span><span class="token punctuation">%</span>S<span class="token punctuation">)</span></span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
| x | y | z | z2 | z3 |
| - | - | - | - | - |
| xxx% | xxx(%) | xx(&amp;) | xxx() | xxx(%S) |
*/</span>
</code></pre><h3 id="quote和nrquote"><code>%quote</code>和<code>%nrquote</code> </h3>
<p><code>%str</code>（包括<code>%nrstr</code>）只在程序编译的阶段起作用；在程序执行阶段是不起作用的。而<code>%quote</code>函数（相对应的还有<code>%nrquote</code>），是在程序执行阶段生效的。</p>
<p><code>%quote</code>与<code>%nrquote</code>两个函数的功能与<code>%str</code>和<code>%nrstr</code>两个函数的功能是一样的，只不过前两者是在程序执行阶段生效，而后两者是在程序编译阶段生效。</p>
<h3 id="bquote和nrbquote"><code>%bquote</code>和<code>%nrbquote</code> </h3>
<p><code>%bquote</code>与<code>%quote</code>，<code>%nrbquote</code>与<code>%``nrquote</code>的生效阶段是一样的，都是在程序执行阶段生效。但是<code>%bquote</code>和<code>%nrbquote</code>，在<code>%bquote</code>与<code>%quote</code>的基础上多了一个功能，即对于不匹配的引号或括号不需要使用多增加一个<code>%</code>（无论是<code>%str</code>、<code>%nrstr</code>、<code>%quote</code>、<code>%nrquote</code>如果有不匹配的引号，则必须要在不匹配的引号前添加<code>%</code>。<code>%</code>类似于转义字符的功能）</p>
<p>建议：一般情况下，都会使用<code>%``bquote</code>和<code>%``nrbquote</code>，基本不使用<code>%``quote</code>和<code>%``nrquote</code></p>
<h3 id="superq"><code>%superq</code> </h3>
<p><code>%``superq</code>宏函数比较特殊，其参数必须是宏变量的名字，而且不用<code>&amp;</code>符号。该函数可以隐藏<code>%``nrbquote</code>函数可隐藏的特殊字符及字母组合。</p>
<p>但<code>%``nrbquote</code>如果参数为宏变量的引用，会在隐藏特殊字符功能前，先尝试解析其宏变量值中的宏引用或者宏变量的引用；而<code>%``superq</code>函数则不会解析其参数宏变量值中的宏引用或者宏变量的引用</p>
<h3 id="unquote"><code>%unquote</code> </h3>
<p><code>%``unquote</code>顾名思义，就是将之前隐藏掉的功能重新激活，去除Quoting的作用</p>
<h3 id="具有掩码作用的宏函数">具有掩码作用的宏函数 </h3>
<p>具有Quoting功能的函数：<code>%qsacn</code>、<code>%qsubstr</code>、<code>%qsysfunc</code>、<code>%qupcase</code>。这些具有Quoting功能的函数，能够隐藏返回结果中的特殊字符的功能。</p>
<table>
<thead>
<tr>
<th>+</th>
<th>-</th>
<th>*</th>
<th>/</th>
<th>&lt;</th>
<th>&gt;</th>
<th>=</th>
<th>&amp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>﹁</td>
<td>^</td>
<td>~</td>
<td>;</td>
<td>,</td>
<td>#</td>
<td>blank</td>
<td>%</td>
</tr>
<tr>
<td>AND</td>
<td>OR</td>
<td>NOT</td>
<td>EQ</td>
<td>NE</td>
<td>LE</td>
<td>LT</td>
<td></td>
</tr>
<tr>
<td>GE</td>
<td>GT</td>
<td>IN</td>
<td>'</td>
<td>''</td>
<td>(</td>
<td>)</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="attrib语句"><code>attrib</code>语句 </h2>
<ol>
<li>
<p>利用<code>attrib</code>删去所有<code>label</code></p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> want<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> have<span class="token punctuation">;</span>
    attrib _all_ <span class="token keyword keyword-label">label</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>设置多个变量的多个属性</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code>attrib x y <span class="token keyword keyword-length">length</span><span class="token operator">=</span><span class="token punctuation">$</span><span class="token number">4</span> <span class="token keyword keyword-label">label</span><span class="token operator">=</span><span class="token string">'TEST VARIABLE'</span><span class="token punctuation">;</span>
attrib x <span class="token keyword keyword-length">length</span><span class="token operator">=</span><span class="token punctuation">$</span><span class="token number">4</span> <span class="token keyword keyword-label">label</span><span class="token operator">=</span><span class="token string">'TEST VARIABLE'</span> y <span class="token keyword keyword-length">length</span><span class="token operator">=</span><span class="token punctuation">$</span><span class="token number">2</span> <span class="token keyword keyword-label">label</span><span class="token operator">=</span><span class="token string">'RESPONSE'</span><span class="token punctuation">;</span>
attrib month1<span class="token operator">-</span>month12 <span class="token keyword keyword-label">label</span><span class="token operator">=</span><span class="token string">'MONTHLY SALES'</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<h2 id="正则表达式">正则表达式 </h2>
<h3 id="模式匹配">模式匹配 </h3>
<ul>
<li>模式匹配能够在一个步骤中从字符串中搜索和提取多个匹配模式。</li>
<li>模式匹配还允许在一个步骤中对字符串进行多次替换。</li>
<li>可以在源文件中搜索字符串并返回匹配的位置。</li>
<li>SAS中的模式匹配可以通过Perl正则表达函数和CALL例程来实现。</li>
</ul>
<h3 id="基本语法">基本语法 </h3>
<h4 id="正则表达式的构成">正则表达式的构成 </h4>
<ul>
<li>Perl正则表达式由<strong>字符</strong>和称为<strong>元字符</strong>的特殊字符组成。</li>
<li>在执行匹配时，SAS将在源字符串中搜索您指定的Perl正则表达式匹配的子字符串。</li>
<li>使用元字符使SAS能够执行某些特殊操作。这些操作包括强制匹配从特定位置开始，并匹配特定的一组字符。</li>
</ul>
<h4 id="reg基本语法">reg基本语法 </h4>
<ul>
<li>
<p>分隔符：</p>
<ul>
<li><code>"/regular-expression/"</code>：成对的正斜杠是默认的分隔符。</li>
</ul>
</li>
<li>
<p>搜寻：</p>
<ul>
<li><code>res = prxmatch("/world/", "Hello world!");</code></li>
</ul>
</li>
<li>
<p>替换：</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> x<span class="token punctuation">;</span>
    res <span class="token operator">=</span> <span class="token function keyword">prxchange</span><span class="token punctuation">(</span><span class="token string">"s/world/planet/"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"Hello world world world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">proc print</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*  结果为： Hello planet planet world */</span>
</code></pre></li>
<li>
<p>解释：</p>
<ol>
<li>"<code>s/world/planet/</code>"， 由3部分组成，**<code>s</code>**指定待替换的元字母， <code>world</code>为正则表达式， <code>planet</code>为新值，即满足正则表达式的内容替换为<code>planet</code></li>
<li><code>2</code>， 指定替换次数，2表示替换前2次，<code>-1</code>表示全部替换</li>
<li><code>Hello world world world</code>， 被匹配字符串</li>
</ol>
</li>
</ul>
<h3 id="sas中的基本函数">SAS中的基本函数 </h3>
<table>
<thead>
<tr>
<th>Function(Args)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>prxparse(regx)</code></td>
<td>以正则式作为输入，输出SAS中指定替代该正则式的<code>id(regx_id)</code></td>
</tr>
<tr>
<td><code>prxmatch(regx/regx_id, string)</code></td>
<td>以正则表达式或者正则表达式id以及被匹配对象作为输入。 返回首次匹配到的开始位置，匹配失败返回0</td>
</tr>
<tr>
<td><code>prxposn(rex_id,rnk, start,length)</code></td>
<td>来获取需要的反向匹配结果。 输入为4个参数：第一个为正则式id，第二个是方向匹配的序号，第三个和第四个是输出参数，函数执行结束它们会被赋值为反向匹配在原匹配字符串中的位置和长度；这样，利用这两个返回的值并结合substr就可以得到反向匹配字符串</td>
</tr>
<tr>
<td><code>prxposn(regx_id,rnk,string)</code></td>
<td>返回子表达式对应的匹配值，注意子表达式含义</td>
</tr>
<tr>
<td><code>prxchange(regx/regx_id,oldstring,newstring,length,trunk,num)</code></td>
<td>替换匹配模式的值</td>
</tr>
<tr>
<td><code>prxsubstr(regx/regx_id,string,start,length)</code></td>
<td>返回首次匹配的位置和长度，匹配失败，则start为0</td>
</tr>
<tr>
<td><code>prxnext(regx/regx_id,start,stop,string,position,length)</code></td>
<td>返回多个匹配位置和长度</td>
</tr>
</tbody>
</table>
<h3 id="一般元字符">一般元字符 </h3>
<table>
<thead>
<tr>
<th>Meta-Character</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>non-metacharacter</code></td>
<td>非"元字符",也可以理解为非特殊字符，即没有特殊意义的字符。</td>
<td><code>"/abc/"</code> 表示匹配包含"<em>abc</em>"的字符串</td>
</tr>
<tr>
<td><code>^</code></td>
<td>在字符串的开始匹配</td>
<td><code>^cat</code>  匹配"cat"，"cats"但不匹配"the cat"</td>
</tr>
<tr>
<td><code>$</code></td>
<td>在字符串的结尾匹配</td>
<td><code>cat$</code>  匹配"the cat" 但不匹配"cat in the hat"</td>
</tr>
<tr>
<td><code>|</code></td>
<td>指定or条件</td>
<td><code>"sas|java"</code> 可以同时匹配"sas"和"java"</td>
</tr>
<tr>
<td><code>.</code></td>
<td>匹配除换行符"\n"之外的任何单个字符</td>
<td><code>r.n</code> 匹配"ron"，"run"，"ran" <code>".*"</code> 可以匹配所有字符串 <code>[.\n]</code>  匹配任意字符</td>
</tr>
<tr>
<td><code>*</code></td>
<td>匹配前字符0次或多次（进行贪婪匹配）</td>
<td><code>cat*</code>  匹配"cat"，"cats" <code>c(at)*</code> 匹配"c", "cat", "catatat" <code>a.*b</code> 匹配"aabab"</td>
</tr>
<tr>
<td><code>+</code></td>
<td>匹配前字符1次或多次（进行贪婪匹配）</td>
<td><code>\d+</code> 匹配一个或多个数字</td>
</tr>
<tr>
<td><code>?</code></td>
<td>匹配前字符0次或1次（进行贪婪匹配）</td>
<td><code>hello?</code> 匹配"hell"，"hello"</td>
</tr>
<tr>
<td><code>*?</code></td>
<td>匹配0次或多次（进行懒惰匹配,匹配到第一个就结束匹配了，不会继续先后匹配）</td>
<td><code>a.*?b</code>匹配"aabab"中的"aab"</td>
</tr>
<tr>
<td><code>+?</code></td>
<td>匹配1次或多次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>?</code></td>
<td>匹配0次或1次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n}?</code></td>
<td>精确匹配n次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n,}?</code></td>
<td>匹配至少n次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n,m}?</code></td>
<td>匹配至少n次，不超过m次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n}</code></td>
<td>匹配n次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n,}</code></td>
<td>匹配至少n次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><code>{n,m}</code></td>
<td>匹配n到m次（进行懒惰匹配）</td>
<td></td>
</tr>
<tr>
<td><strong>分组</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>( )</code></td>
<td>表示一个分组。</td>
<td><code>"/(abc)(def)/"</code> "<em>abc</em>"表示组1，"<em>def</em>"表示组2</td>
</tr>
<tr>
<td><code>[...]</code></td>
<td>匹配中括号内的任一字符</td>
<td></td>
</tr>
<tr>
<td><code>[^....]</code></td>
<td>不匹配中括号内的任何字符</td>
<td></td>
</tr>
<tr>
<td><code>[a-z]</code></td>
<td>匹配a到z范围内的任一字符</td>
<td></td>
</tr>
<tr>
<td><code>[^a-z]</code></td>
<td>不匹配a到z范围内的任何字符</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>(?:...)</code></td>
<td>指定一个非捕获组</td>
<td>"()"的字符中以"?"开头的话这些元素将不能被认定为一组字符，这一写法常常用于断言</td>
</tr>
<tr>
<td><code>{ }</code> <code>[ ]</code> <code>( )</code> <code>^</code> <code>$</code> <code>.</code> <code>|</code> <code>*</code> <code>+</code> <code>?</code> <code>\</code></td>
<td>这个字符串在正则表达式中具有一些特殊含义，若想匹配，则需要在前面加上"\"。</td>
<td><code>"/\\/"</code> 表示匹配包含"\"的字符串，其他符号同理</td>
</tr>
<tr>
<td><strong>转义</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>\</code></td>
<td>这个字符是正则表达式的基本字符，它使下一个出现的字符被赋予特殊含义。</td>
<td><code>"/\d/"</code> 这个表达并非表示匹配字符"d", 而需要将"\d"看为一个整体，表示一个数字</td>
</tr>
<tr>
<td><code>\1</code> <code>\2</code> <code>\3</code> <code>\n</code></td>
<td>n是一个具体的数字，代表匹配捕捉缓存区n中的数据，缓存区n可以理解成组n</td>
<td><code>"/(abc)(def) \1\2/"</code> "\1"可以代表组1中被缓存的"abc"字符串，"\2"可以代表"def"字符串，这样我可以就可以将要写的表达式"/(abc)(def)(abc)(def)/"简化成前方的写法</td>
</tr>
<tr>
<td><code>\a</code></td>
<td>警示字符，指代ASCII编码为7的字符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\A</code></td>
<td>匹配字符串中首个字符，一般用于在开头插入字符串</td>
<td><code>prxchange("s/\A/start/",-1,"adc")</code>结果是"startadc"</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>匹配一个字符边界</td>
<td><code>"er\b"</code>  匹配 了"never"中的"er" 字符串 , 但并不匹配"verb" 中的"er"</td>
</tr>
<tr>
<td><code>\B</code></td>
<td>匹配一个非字符边界</td>
<td>和上面"\b"的例子会是相反的结果</td>
</tr>
<tr>
<td><code>\cA-\cZ</code></td>
<td>匹配一个控制字符， 控制字符都是非打印的字符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\C</code></td>
<td>匹配一个单字节的字符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\d</code></td>
<td>匹配一个数字，即0-9</td>
<td><code>"/\d/"</code> 匹配0-9中的任何一个</td>
</tr>
<tr>
<td><code>\D</code></td>
<td>匹配一个非数字，即除了0-9中的任何一个字符</td>
<td><code>"/\D/"</code> 匹配除了0-9中的任何一个字符</td>
</tr>
<tr>
<td><code>\e</code></td>
<td>匹配一个转义字符</td>
<td>“\n”换行符，”\r”回车符都属于转义字符</td>
</tr>
<tr>
<td><code>\E</code></td>
<td>指代的是字符大小写修饰符</td>
<td>prxchange(“s/\E/-/“,-1,”adcEFG”) 输出的结果”-a-d-c-E-F-G-“</td>
</tr>
<tr>
<td><code>\f</code></td>
<td>匹配一个换页符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\l</code></td>
<td>申明下一个字符为小写</td>
<td>“\lABC” 可以匹配”aBC”</td>
</tr>
<tr>
<td><code>\L</code></td>
<td>申明下一个字符的\E元素是小写的</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\n</code></td>
<td>n是字母n，代表换行符</td>
<td>可以匹配换行符</td>
</tr>
<tr>
<td><code>\num</code></td>
<td>num是一个数字，代表组num的缓存区, 在匹配时使用</td>
<td><code>"/(abc)\1/"</code>, 中"\1"可以代表组1中被缓存的"abc"字符串</td>
</tr>
<tr>
<td><code>$num</code></td>
<td>num是一个数字，代表组num的缓存区, 在替换时使用</td>
<td><code>prxchange("s/(abc)(def)/$1/",-1,"abcdef")</code> 结果是"abc"</td>
</tr>
<tr>
<td><code>\Q</code></td>
<td>转义所有非文本字符</td>
<td><code>"\Q\%"</code> 可以匹配"%"</td>
</tr>
<tr>
<td><code>\r</code></td>
<td>匹配一个回车符</td>
<td>回车符</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>匹配一个空格，包括空格，tab键，分页符和其他空格</td>
<td><code>\s</code> 等于[\f\n\r\t\v]</td>
</tr>
<tr>
<td><code>\S</code></td>
<td>匹配一个非空格</td>
<td>\S就等于除了[\f\n\r\t\v]之外的所有字符</td>
</tr>
<tr>
<td><code>\t</code></td>
<td>匹配一个tab字符</td>
<td>相当于电脑上tab键的效果</td>
</tr>
<tr>
<td><code>\u</code></td>
<td>申明下一个字符为大写</td>
<td><code>"\uabc"</code> 可以匹配"Abc"</td>
</tr>
<tr>
<td><code>\U</code></td>
<td>申明下一个字符的\E元素是大写的</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\v or \x0B</code></td>
<td>垂直空白格</td>
<td>非常规空格的一种</td>
</tr>
<tr>
<td><code>\w</code></td>
<td>匹配字母，数字和下划线，即sas变量命名规则</td>
<td><code>"\w+"</code>匹配"abc123_"</td>
</tr>
<tr>
<td><code>\W</code></td>
<td>匹配除了字母，数字和下划线的所有字符</td>
<td><code>"\W+"</code> 可以匹配" 你好"</td>
</tr>
<tr>
<td><code>\ddd</code></td>
<td>d为8进制数字，匹配一个8进制的字符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\xdd</code></td>
<td>d为16进制数字，匹配一个16进制的字符</td>
<td>不常用</td>
</tr>
<tr>
<td><code>\z</code></td>
<td>匹配字符串中最后字符，一般用于在最后插入字符串</td>
<td><code>prxchange("s/\z/end/",-1,"adc")</code> 结果会是"adcend"</td>
</tr>
<tr>
<td><code>\Z</code></td>
<td>匹配字符串中最后字符, 若最后是换行符，则匹配换行符前的字符</td>
<td>可以理解为段落前的最后一个可见字符</td>
</tr>
</tbody>
</table>
<h3 id="元字符分组">元字符分组 </h3>
<table>
<thead>
<tr>
<th><strong>元字符</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>[...]</td>
<td>匹配中括号内的任一字符</td>
</tr>
<tr>
<td>[^....]</td>
<td>不匹配中括号内的任何字符</td>
</tr>
<tr>
<td>[a-z]</td>
<td>匹配a到z范围内的任一字符</td>
</tr>
<tr>
<td>[^a-z]</td>
<td>不匹配a到z范围内的任何字符</td>
</tr>
<tr>
<td>[[:alpha:]]、[[:^alpha:]]</td>
<td>匹配或不匹配字母字符</td>
</tr>
<tr>
<td>[[:alnum:]]、[[:^alnum:]]</td>
<td>匹配或不匹配字母数值字符</td>
</tr>
<tr>
<td>[[:ascii:]]、[[^:ascii:]]</td>
<td>匹配ASCII字符或非ASCII字符</td>
</tr>
<tr>
<td>[[:blank:]]、[[^:blank:]]</td>
<td>匹配空白或非空白字符</td>
</tr>
<tr>
<td>[[:cntrl:]]、[[^:cntrl:]]</td>
<td>匹配控制或非控制字符</td>
</tr>
<tr>
<td>[[:digit:]]、[[^:digit:]]</td>
<td>匹配数字或非数字字符</td>
</tr>
<tr>
<td>[[:graph:]]、[[^:graph:]]</td>
<td>匹配可见字符（排除空格），或相反</td>
</tr>
<tr>
<td>[[:lower:]]、[[^:lower:]]</td>
<td>匹配小写字符，或相反</td>
</tr>
<tr>
<td>[[:print:]]、[[^:print:]]</td>
<td>匹配可打印字符，或相反</td>
</tr>
<tr>
<td>[[:punct:]]、[[^:punct:]]</td>
<td>匹配标点符号，或相反</td>
</tr>
<tr>
<td>[[:space:]]、[[^:space:]]</td>
<td>匹配空格或非空格</td>
</tr>
<tr>
<td>[[:upper:]]、[[^:upper:]]</td>
<td>匹配大写字符或相反</td>
</tr>
<tr>
<td>[[:word:]]、[[^:word:]]</td>
<td>匹配一个单词或相反</td>
</tr>
<tr>
<td>[[:xdigit:]]、[[^:xdigit:]]</td>
<td>匹配一个十六进制字符或不匹配</td>
</tr>
</tbody>
</table>
<h3 id="前向搜索和后向搜索断言">前向搜索和后向搜索【断言】 </h3>
<table>
<thead>
<tr>
<th><strong>元字符</strong></th>
<th><strong>描述</strong></th>
<th><strong>举例</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>(？=...)</td>
<td>肯定的，向前的回顾</td>
<td>"/abc(?=A)/"匹配"abcABC"字符串中的"abc"</td>
</tr>
<tr>
<td>(？！...)</td>
<td>否定的，向前的回顾</td>
<td>"/abc(?!A)/"不能匹配"abcABC"字符串中的"abc"</td>
</tr>
<tr>
<td>(?&lt;=...)</td>
<td>肯定的，向后的回顾</td>
<td>"(?&lt;=A)abc"匹配"CBAabc"字符串中的"abc"</td>
</tr>
<tr>
<td>(?&lt;!...)</td>
<td>否定的，向后的回顾</td>
<td>"(?&lt;!A)abc"不能匹配"CBAabc"字符串中的"abc"</td>
</tr>
</tbody>
</table>
<h3 id="注释和内联修饰符">注释和内联修饰符 </h3>
<table>
<thead>
<tr>
<th><strong>元字符</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>(?#text)</td>
<td>指定注释</td>
</tr>
<tr>
<td>(?imsx)</td>
<td>指定内嵌的模式匹配注释</td>
</tr>
</tbody>
</table>
<h3 id="表达式的组合">表达式的组合 </h3>
<table>
<thead>
<tr>
<th><strong>元字符</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ST</td>
<td>如果对于S来说A比A’好，那么AB就好于A'B'.</td>
</tr>
<tr>
<td>S|T</td>
<td>如果S能匹配，那么就比只有T能匹配时好</td>
</tr>
<tr>
<td>S{repeat-count}</td>
<td>匹配尽可能多的S</td>
</tr>
<tr>
<td>S{min,max}</td>
<td>匹配max次到min次S</td>
</tr>
<tr>
<td>S{min,max}?</td>
<td>匹配min次到max次S</td>
</tr>
<tr>
<td>S?,S*,S+</td>
<td>匹配S{0,1}，S{0,big-number}. S{1,big-number}</td>
</tr>
<tr>
<td>S??, S*?, S+</td>
<td>同S{0,1}？，S{0,big-number}?, S{1,big-number}？</td>
</tr>
<tr>
<td>(?=S), (?&lt;=S)</td>
<td>考虑S的最佳匹配</td>
</tr>
<tr>
<td>(?!S), (?&lt;!S)</td>
<td>不需要描述组内操作顺序，因为只有S是否匹配是重要的</td>
</tr>
</tbody>
</table>
<h3 id="常用正则">常用正则 </h3>
<table>
<thead>
<tr>
<th>用途</th>
<th>正则表达式</th>
</tr>
</thead>
<tbody>
<tr>
<td>匹配中文字符</td>
<td><code>[\u4e00-\u9fa5]</code></td>
</tr>
<tr>
<td>匹配双字节字符 (包括汉字在内)</td>
<td><code>[^\x00-\xff]</code> 可以用来计算字符串的长度（一个双字节字符长度计2，ASCII字符计1）</td>
</tr>
<tr>
<td>匹配空白行</td>
<td><code>\n\s*\r</code> 评注：可以用来删除空白行</td>
</tr>
<tr>
<td>匹配HTML标记</td>
<td><code>&lt;(\S*?)[^&gt;]</code><em><code>&gt;.</code></em><code>?&lt;/\1&gt;|&lt;.*? /&gt;</code>仅仅能匹配部分，对于复杂的嵌套标记依旧无能为力</td>
</tr>
<tr>
<td>匹配首尾空白字符</td>
<td><code>^\s*|\s*$</code>可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式</td>
</tr>
<tr>
<td>匹配Email地址</td>
<td><code>\w+([-+.]\w+)@\w+([-.]\w+).\w+([-.]\w+)</code> 表单验证时很实用</td>
</tr>
<tr>
<td>匹配网址URL</td>
<td><code>[a-zA-z]+://[^\s]*</code> 基本可以满足需求</td>
</tr>
<tr>
<td>匹配帐号是否合法 (字母开头，允许5-16字节，允许字母数字下划线)</td>
<td><code>[a-zA-Z0-9_]{4,15}$</code> 表单验证时很实用</td>
</tr>
<tr>
<td>匹配国内电话号码</td>
<td><code>\d{3}-\d{8}|\d{4}-\d{7}</code> 匹配形式如 0511-4405222 或 021-87888822</td>
</tr>
<tr>
<td>匹配腾讯QQ号</td>
<td><code>[1-9][0-9]{4,}</code> 腾讯QQ号从10000开始</td>
</tr>
<tr>
<td>匹配中国邮政编码</td>
<td><code>[1-9]\d{5}(?!\d)</code> 中国邮政编码为6位数字</td>
</tr>
<tr>
<td>匹配身份证</td>
<td><code>\d{15}|\d{18}</code> 中国的身份证为15位或18位</td>
</tr>
<tr>
<td>匹配ip地址</td>
<td><code>\d+.\d+.\d+.\d+</code> 提取ip地址时有用</td>
</tr>
<tr>
<td>匹配特定数字</td>
<td><code>^\d*</code>匹配正整数 <code>^−[1−9]\d*</code> 匹配负整数 <code>^-?[1-9]\d*</code>匹配整数 <code>^[1−9]\d∗|0</code> 匹配非负整数（正整数+0） <code>^-[1-9]\d*|0</code>匹配非正整数（负整数+0） <code>^[1−9]\d*.\d*|0.\d*[1−9]\d*</code> 匹配正浮点数 <code>^-([1-9]\d*.\d*|0.\d*[1-9]\d*)</code>匹配负浮点数 <code>^−?([1−9]\d*.\d*|0.\d*[1−9]\d*|0?.0+|0)</code>匹配浮点数 <code>^[1−9]\d*.\d*|0.\d*[1−9]\d*|0?\.0+|0</code>匹配非负浮点数（正浮点数+0） <code>^(-([1-9]\d*.\d*|0.\d*[1-9]\d*))|0?\.0+|0</code>匹配非正浮点数（负浮点数+0）</td>
</tr>
<tr>
<td>匹配特定字符串</td>
<td><code>^[A-Za-z]+</code>匹配由26个英文字母组成的字符串 <code>^[A-Z]+</code>匹配由26个英文字母的大写组成的字符串 <code>^[a-z]+</code>匹配由26个英文字母小写组成的字符串 <code>^[A-Za-z0-9]+</code>匹配由数字和26个英文字母组成的字符串 <code>^\w+$</code>匹配由数字、26个英文字母或者下划线组成的字符串</td>
</tr>
</tbody>
</table>
<h2 id="length语句"><code>length</code>语句 </h2>
<h3 id="使用说明">使用说明 </h3>
<ul>
<li>指定变量的长度（储存长度，而不一定等于我们看到的长度）。</li>
<li>数值变量的长度默认为8个字符；</li>
<li>字符变量的长度默认由它的第一个观测值决定；</li>
<li>字符型变量需要在长度前面加上<code>$</code>符号。</li>
</ul>
<h3 id="注意事项">注意事项 </h3>
<ol>
<li><code>length</code>语句应该使用在data步的第一句。否则可能出现这样的warning。
<blockquote>
<p>WARNING: Length of character variable x1 has already been set.<br>
Use the LENGTH statement as the very first statement in the DATA STEP to declare the length of a character variable.</p>
</blockquote>
</li>
<li>变量会按照<code>length</code>语句中的顺序展示，并默认放在数据集最前面。</li>
<li>可以同时对多个变量指定同一个长度。多个变量都默认为后面第一个指定的类型长度。</li>
<li><code>length</code>为申明语句，所以其中的变量必须要使用在后续的执行语句中。否则会出现这样的log issue：
<blockquote>
<p>NOTE: Variable x1 is uninitialized.</p>
</blockquote>
</li>
</ol>
<h2 id="retain语句"><code>retain</code>语句 </h2>
<h3 id="retain使用说明"><code>retain</code>使用说明 </h3>
<ul>
<li>不使用<code>retain</code>：在每次循环执行时会把PDV中的变量值清空，即置为缺失值（<code>.</code>）。</li>
<li>使用<code>retain</code>：在每次循环执行时保留上一次PDV中的变量值。</li>
<li><code>sum</code>语句和<code>set</code>语句会自动<code>retain</code>变量。</li>
</ul>
<h3 id="retain注意事项"><code>retain</code>注意事项 </h3>
<ul>
<li>在DATA步刚开始执行的时候：
<ul>
<li>自动生成变量会被附上初始值：<code>_n_=1</code>、 <code>_error_=0</code>、<code>first.var=1</code>、 <code>last.var=1</code>等；</li>
<li>如果<code>retain</code>语句对某变量设置了的初始值，则对应的变量被设为指定的值；</li>
<li><code>sum</code>语句的变量会被初始化为0；</li>
<li>其他的变量(<code>新建变量</code>和<code>set的数据集</code>)都会被设为缺失值。</li>
</ul>
</li>
<li>SAS执行过程中再次回到DATA语句时：
<ul>
<li>自动生成变量的值会被保留；</li>
<li>来自<code>retain</code>语句、<code>sum</code>语句、或数据集中的变量值会被保留；</li>
<li>其他的变量会被设为缺失值（<code>.</code>）。</li>
</ul>
</li>
</ul>
<h3 id="案例使用retain前向填充缺失值">案例：使用<code>retain</code>前向填充缺失值 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 用该缺失值的前一个非缺失值来填补该缺失值 */</span>
<span class="token step keyword">data</span> ex1<span class="token punctuation">;</span>
    <span class="token keyword keyword-retain">retain</span> old_x<span class="token punctuation">;</span>
    input x <span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> x <span class="token operator-keyword operator">ne</span> <span class="token punctuation">.</span> <span class="token keyword keyword-THEN">THEN</span> old_x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword keyword-else">else</span> x <span class="token operator">=</span> old_x<span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
    1 2 . 3
<span class="token punctuation">;</span></span>

<span class="token comment">/*
old_x    x
    1    1
    2    2
    2    2
    3    3
*/</span>
</code></pre><h3 id="案例使用retain给数据加序号">案例：使用<code>retain</code>给数据加序号 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 使用retain语句 */</span>
<span class="token step keyword">data</span> ex2<span class="token punctuation">;</span>
    <span class="token keyword keyword-retain">retain</span> subject <span class="token number">0</span><span class="token punctuation">;</span>
    input x <span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    subject <span class="token operator">=</span> subject <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    1 3 5
<span class="token punctuation">;</span></span>

<span class="token comment">/* 利用sum语句简化 */</span>
<span class="token step keyword">data</span> ex2<span class="token punctuation">;</span>
    input x <span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    subject <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    1 3 5
<span class="token punctuation">;</span></span>

<span class="token comment">/* 利用PDV中自动变量_n_进一步简化 */</span>
<span class="token step keyword">data</span> ex2<span class="token punctuation">;</span>
    input x <span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    n <span class="token operator">=</span> _n_<span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    1 3 5
<span class="token punctuation">;</span></span>

</code></pre><h3 id="案例set语句自动retain变量">案例：<code>set</code>语句自动<code>retain</code>变量 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> one<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> x y;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    1 2
<span class="token punctuation">;</span></span>

<span class="token step keyword">data</span> two<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> _n_ <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-set">set</span> one<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> new;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    3
    4
    5
<span class="token punctuation">;</span></span>

<span class="token comment">/*
x   y    new
1   2    3
1   2    4
1   2    5
*/</span>
</code></pre><h2 id="set语句"><code>set</code>语句 </h2>
<h3 id="set使用说明"><code>set</code>使用说明 </h3>
<ul>
<li>一个DATA步中可以有多个<code>set</code>语句，一个<code>set</code>语句中可以有任意个SAS数据集。</li>
<li>每一个<code>set</code>语句执行时，SAS就会读一个观测到PDV中，多个<code>set</code>语句含有多个数据指针。</li>
<li><code>set</code>语句默认会对数据集中的变量进行<code>retain</code>处理。</li>
</ul>
<h3 id="一个set语句中多个数据集">一个<code>set</code>语句中多个数据集 </h3>
<ul>
<li>其执行顺序为：先读取<code>data1</code>直至最后一条数据，然后后再读取<code>data2</code>，并将其纵向合并。</li>
<li>变量类型按照第一个数据集中的变量格式来定义所有变量；</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> ex1<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> data1 data2<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x   y
a1  .
a2  .
a3  .
.   b1
.   b2
*/</span>
</code></pre><h3 id="多个set语句中一个数据集">多个<code>set</code>语句中一个数据集 </h3>
<ul>
<li>读取的观测是以少的观测的数据集为主。</li>
<li>编译后内存出现两条数据指针分别指向<code>data1</code>，<code>data2</code>，同时产生一个PDV；</li>
<li>同时读取<code>data1</code>的第一条观测与<code>data2</code>的第一条观测进入同一条PDV，然后输出，再返回DATA步开头。</li>
<li>重复进行，当读入<code>data1</code>的第三行时，<code>data2</code>中的指针已经指向了文件尾部，所以跳出DATA步。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> data1<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> x;</span>
  cards<span class="token punctuation">;</span>
  a1
  a2
  a3
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> data2<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> y;</span>
  cards<span class="token punctuation">;</span>
  b1
  b2
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> ex2<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> data1<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> data2<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x  y
a1 b1
a2 b2
*/</span>
</code></pre><h3 id="选项pointvariable">选项：<code>point=Variable</code> </h3>
<ul>
<li>规定一个临时变量控制<code>set</code>语句读入的观测序号，使用选项<code>point=</code>时，经常要用<code>stop</code>语句来终止data步的执行</li>
<li><code>Point=Variable</code>对应的是变量，不能直接赋值数字；省略<code>stop</code>后会让程序进入死循环，不用<code>stop</code>语句sas无法判断该数据指针是否指向了最后一条观测，从而会陷入死循环。如果不用<code>output</code>，会得不到数据集，<code>point</code>和<code>stop</code>一般是连在一起使用；</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 利用Point=选项读取指定观测 */</span>
<span class="token step keyword">data</span> a<span class="token punctuation">;</span>
  <span class="token keyword keyword-set">set</span> account <span class="token punctuation">;</span>
  obs<span class="token operator">=</span>_n_<span class="token punctuation">;</span>

<span class="token step keyword">data</span> b<span class="token punctuation">;</span>
  <span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> a point<span class="token operator">=</span>i<span class="token punctuation">;</span> <span class="token comment">/*读入数据集a中的第3,5,7,4观测*/</span>
    <span class="token keyword keyword-if">if</span> _error_<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-then">then</span> abort<span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
  stop<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h3 id="选项nobsvariable">选项：<code>nobs=Variable</code> </h3>
<ul>
<li>规定一个临时变量，记录读入数据集的观测总数。此变量不含在新产生的数据集中；</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 利用NOBS=选项获取观测总数 */</span>
<span class="token step keyword">data</span> acc<span class="token punctuation">;</span>
  <span class="token keyword keyword-set">set</span> account <span class="token punctuation">;</span>
  obs<span class="token operator">=</span>_n_<span class="token punctuation">;</span>

<span class="token step keyword">data</span> a<span class="token punctuation">;</span>
  <span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> last <span class="token keyword keyword-by">by</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">/*临时变量为last */</span>
    <span class="token keyword keyword-set">set</span> acc point<span class="token operator">=</span>i nobs<span class="token operator">=</span>last<span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
  stop<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h3 id="选项endvariable">选项：<code>end=Variable</code> </h3>
<ul>
<li>规定一个临时变量，作为文件结束的标识。文件结束时取值1，其它观测取0。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 利用END=选项获取最后一个观测 */</span>
<span class="token step keyword">data</span> acc<span class="token punctuation">;</span>
  <span class="token keyword keyword-set">set</span> account <span class="token punctuation">;</span>
  obs<span class="token operator">=</span>_n_<span class="token punctuation">;</span>

<span class="token step keyword">data</span> a<span class="token punctuation">;</span>
  <span class="token keyword keyword-set">set</span> acc <span class="token keyword keyword-end">end</span><span class="token operator">=</span>last_obs<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> last_obs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h2 id="merge语句"><code>merge</code>语句 </h2>
<h3 id="没有by语句的merge">没有<code>by</code>语句的<code>merge</code> </h3>
<ul>
<li>对应行数的观测依次进行合并（不是笛卡儿积）。</li>
<li>若数据集中存在相同变量，则用后面数据集中变量的值覆盖前面数据集中变量的值。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> one<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> no a b;</span>
  <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
  1  1  11
  2  2  22
  3  3  33
  <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> two<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> no c d;</span>
  <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
  4  44  444
  5  55  555
  <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> total<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> one two<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
no a b c d
4  1  11  44  555
5  2  22  55  555
3  3  33   .  .
*/</span>
</code></pre><h3 id="使用by语句的merge">使用<code>by</code>语句的<code>merge</code> </h3>
<ul>
<li>按照<code>by</code>变量的取值进行匹配合并，只有当<code>by</code>变量的值相同时才合并。</li>
<li>有相同变量时，后面的值会覆盖前面的值，并报出一个<code>warning</code>。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> one<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> no a b;</span>
  <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
  1  1  11
  2  2  22
  3  3  33
  <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> two<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> no c d;</span>
  <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
  4  44  444
  5  55  555
  <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">one</span><span class="token punctuation">;</span></span><span class="token keyword keyword-by">by</span> no<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">two</span><span class="token punctuation">;</span></span><span class="token keyword keyword-by">by</span> no<span class="token punctuation">;</span>
<span class="token step keyword">data</span> total<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> one two<span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> no<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
no a b c d
4  1  11  .   .
5  2  22  44  444
3  3  33   .  .
5  .  .   55  555
*/</span>
</code></pre><h3 id="多表查询">多表查询 </h3>
<h4 id="笛卡尔积两个表所有可能的">笛卡尔积：两个表所有可能的 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> table2<span class="token punctuation">;</span>
   <span class="token keyword keyword-set">set</span> t1<span class="token punctuation">;</span>
   <span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> n<span class="token punctuation">;</span>
      <span class="token keyword keyword-set">set</span> table1 point<span class="token operator">=</span>i nobs<span class="token operator">=</span>n<span class="token punctuation">;</span>
      <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">table</span><span class="token number">2</span><span class="token punctuation">;</span></span>
   <span class="token keyword keyword-by">by</span> usubjid<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h4 id="内联接两个表共有的数据">内联接：两个表共有的数据 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> <span class="token function keyword">tablea</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>a<span class="token punctuation">)</span> <span class="token function keyword">tableb</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> a <span class="token keyword keyword-and">and</span> b<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="左连接匹配后保留左表所有数据左表顺序保持不变">左连接：匹配后保留左表所有数据，左表顺序保持不变 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableA</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableB</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tableF<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> <span class="token function keyword">tablea</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>a<span class="token punctuation">)</span> tableb<span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> a<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="左连接只保留左表独有的数据">左连接：只保留左表独有的数据 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> <span class="token function keyword">tablea</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>a<span class="token punctuation">)</span> <span class="token function keyword">tableb</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> a <span class="token keyword keyword-and">and</span> <span class="token operator-keyword operator">not</span> b<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="右连接匹配后保留右表所有数据右表顺序保持不变">右连接：匹配后保留右表所有数据，右表顺序保持不变 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> tablea <span class="token function keyword">tableB</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> b<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="右连接只保留右表独有的数据">右连接：只保留右表独有的数据 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> <span class="token function keyword">tablea</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>a<span class="token punctuation">)</span> <span class="token function keyword">tableb</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> <span class="token operator-keyword operator">not</span> a <span class="token keyword keyword-and">and</span> b<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="全连接两个表的匹配数据及未匹配的数据">全连接：两个表的匹配数据及未匹配的数据 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> tablea tableb<span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h4 id="全连接两个表各自的独有数据">全连接：两个表各自的独有数据 </h4>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* data merge */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tablea</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">tableb</span><span class="token punctuation">;</span></span>  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
<span class="token step keyword">data</span> tablef<span class="token punctuation">;</span>
  <span class="token keyword keyword-merge">merge</span> <span class="token function keyword">tablea</span><span class="token punctuation">(</span><span class="token operator-keyword operator">in</span><span class="token operator">=</span>a<span class="token punctuation">)</span> <span class="token function keyword">tableb</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-by">by</span> id<span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> <span class="token operator-keyword operator">not</span> a <span class="token keyword keyword-or">or</span> <span class="token operator-keyword operator">not</span> b<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h2 id="array语句"><code>array</code>语句 </h2>
<h3 id="array使用说明"><code>array</code>使用说明 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-ARRAY">ARRAY</span>  数组名<span class="token punctuation">{</span>下标<span class="token punctuation">}</span>  <span class="token operator">&lt;</span><span class="token punctuation">$</span><span class="token operator">&gt;&lt;</span>长度<span class="token operator">&gt;</span>  <span class="token operator">&lt;</span><span class="token operator">&lt;</span>数组元素<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>初始值<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

</code></pre><ol>
<li><code>数组名{下标}</code>：下标表示元素的个数和排列的范围，下标括号建议使用<code>{}</code>，有以下几种指定方式。
<ul>
<li>显示下标：给定一个数字，下标数字应该等于变量元素个数。</li>
<li>隐式下标：在声明数组时没有给出下标值，使用一个新变量替代。</li>
<li><code>*</code>：使用<code>*</code>会自动定义为元素个数。</li>
</ul>
</li>
<li><code>&lt;$&gt;&lt;长度&gt;</code>：定义数组元素中新变量的长度。<code>&lt;$&gt;</code>定义为字符数组（适用于数组元素为新变量情形）。</li>
<li><code>&lt;数组元素&gt;</code>：有以下几种指定方式。
<ul>
<li>数据集中的类型相同的若干个变量名。</li>
<li><code>_character_</code>：定义为数据集中所有字符型变量的数组。</li>
<li><code>_numeric_</code>：定义为数据集中所有数值型型变量的数组。</li>
<li><code>_temporary_</code>：定义为临时数组，它的元素是具体的数值或字符串。引用时必须用数组名和下标，且不能用<code>*</code>下标来引用所有元素；</li>
<li>如果不指定则为缺失值的数值/字符型(<code>$</code>)数组。</li>
</ul>
</li>
<li><code>&lt;(初始值)&gt;</code>：数组元素的初始值，数组元素和初值通过对应位置来确定。</li>
</ol>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> arrya<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> test<span class="token punctuation">;</span>
    <span class="token keyword keyword-array">array</span> ary_1 <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-name">name</span> sex<span class="token punctuation">;</span>         <span class="token comment">/*数组ary_1中包含name sex两个元素*/</span>
    <span class="token keyword keyword-array">array</span> ary_2 <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> age height weight<span class="token punctuation">;</span><span class="token comment">/*数组ary_2中包含age height weight三个元素*/</span>
    <span class="token keyword keyword-array">array</span> ary_3 <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> _character_ <span class="token punctuation">;</span>     <span class="token comment">/*数组ary_3元素为class中所有字符型变量*/</span>
    <span class="token keyword keyword-array">array</span> ary_4 <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> _numeric_ <span class="token punctuation">;</span>       <span class="token comment">/*数组ary_4元素为class中所有数值型变量*/</span>
    <span class="token keyword keyword-array">array</span> ary_5 <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">$</span><span class="token punctuation">;</span>                <span class="token comment">/*数组ary_5元素三个为缺失值的字符型变量*/</span>
    <span class="token keyword keyword-array">array</span> ary_6 <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>                 <span class="token comment">/*数组ary_6元素三个为缺失值的数值型变量*/</span>

    <span class="token keyword keyword-array">array</span> x<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> red greeny ellow<span class="token punctuation">;</span>      <span class="token comment">/* 定义一维 */</span>
    <span class="token keyword keyword-array">array</span> x<span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span> scorel<span class="token operator">-</span>score15<span class="token punctuation">;</span>      <span class="token comment">/* 定义二维: 15个变量按顺序从左上角开始逐行放入这个二维数组 */</span>
    <span class="token keyword keyword-array">array</span> x<span class="token punctuation">{</span><span class="token number">1</span>:<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span>:<span class="token number">3</span><span class="token punctuation">}</span> scorel<span class="token operator">-</span>score15<span class="token punctuation">;</span>  <span class="token comment">/* 定义二维（另一种定义方式）: 当用1作为数组下界时可以省略 */</span>

    <span class="token keyword keyword-array">array</span> t<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">/* 会产生新变量t1,t2,t3; */</span>
    <span class="token keyword keyword-array">array</span> t<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> _temporary_ <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* 若用临时数组，则不会产生新变量 */</span>

    <span class="token comment">/* 隐式下标定义方式 */</span>
    <span class="token keyword keyword-array">array</span> testa<span class="token punctuation">{</span>i<span class="token punctuation">}</span> <span class="token punctuation">$</span> <span class="token number">12</span> x1<span class="token operator">-</span>x10<span class="token punctuation">;</span>

    <span class="token comment">/* 数组元素的个数与初值的个数相同，把初值90,80和70依次赋给变量t1，t1和t3。*/</span>
    <span class="token keyword keyword-array">array</span> testb<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> t1 t2 t3 <span class="token punctuation">(</span><span class="token number">90</span> <span class="token number">80</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* 分配5给ab1，4给ab2，3给ab3，因数组元素比给出的初始值多，多余的变量ab4和ab5为缺失值，SAS系统将发布一条警告信息。 */</span>
    <span class="token keyword keyword-array">array</span> ab<span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token number">4</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="通过下标引用数组元素">通过下标引用数组元素 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> new<span class="token punctuation">;</span>
  <span class="token input"><span class="token input keyword">input</span> x1-x5;</span>
  <span class="token keyword keyword-array">array</span> test<span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> x1<span class="token operator">-</span>x5<span class="token punctuation">;</span>
  <span class="token keyword keyword-put">put</span> test<span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token operator">=</span> test<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">=</span><span class="token punctuation">;</span>
  <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
  1 2 3 4 5
<span class="token punctuation">;</span></span>
<span class="token comment">/* 输出x4和x2的值，即数组元素test(4)引用x4,数组元素test(2)引用x2. */</span>
</code></pre><h3 id="使用do循环遍历数组元素">使用<code>do</code>循环遍历数组元素 </h3>
<ul>
<li>
<p>方法1：使用<code>do over</code></p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code> <span class="token keyword keyword-array">array</span> _num _numeric_<span class="token punctuation">;</span>
 <span class="token keyword keyword-do over">do over</span> _num<span class="token punctuation">;</span>
    _num<span class="token operator">=</span>_num<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span>
 <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>方法2：使用<code>dim</code>函数</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* dim函数得到数组中元素的个数 */</span>
<span class="token keyword keyword-array">array</span> day<span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span> d1<span class="token operator">-</span>d4<span class="token punctuation">;</span>
<span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> <span class="token function keyword">dim</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span>
  day<span class="token punctuation">{</span>i<span class="token punctuation">}</span> <span class="token operator">=</span> day<span class="token punctuation">{</span>i<span class="token punctuation">}</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>方法3：指定范围</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* day(i)则只引用数组中选定的特殊元素 */</span>
<span class="token keyword keyword-array">array</span> day<span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span> d1<span class="token operator">-</span>d7<span class="token punctuation">;</span>
<span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">2</span> <span class="token keyword keyword-to">to</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> <span class="token number">7</span> <span class="token keyword keyword-by">by</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>

</code></pre></li>
</ul>
<h3 id="使用of运算符处理所有元素">使用<code>of</code>运算符处理所有元素 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> array_example_of<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> a1 a2 a3 a4;</span>
    <span class="token keyword keyword-array">array</span> <span class="token function keyword">a</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> a1<span class="token operator">-</span>a4<span class="token punctuation">;</span>
    a_sum<span class="token operator">=</span><span class="token function keyword">sum</span><span class="token punctuation">(</span>of <span class="token function keyword">a</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    a_mean<span class="token operator">=</span><span class="token function keyword">mean</span><span class="token punctuation">(</span>of <span class="token function keyword">a</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    a_min<span class="token operator">=</span><span class="token function keyword">min</span><span class="token punctuation">(</span>of <span class="token function keyword">a</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    21 4 52 11
    96 25 42 6
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h3 id="in运算符访问数组元素的值"><code>in</code>运算符访问数组元素的值 </h3>
<p>可以使用<code>in</code>运算符访问数组中的值，该运算符检查数组行中是否存在值。</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> array_in_example<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> a1 $ a2 $ a3 $ a4 $;</span>
    <span class="token keyword keyword-array">array</span> <span class="token function keyword">colours</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> a1<span class="token operator">-</span>a4<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token string">'yellow'</span> <span class="token operator-keyword operator">in</span> colours <span class="token keyword keyword-then">then</span> available<span class="token operator">=</span><span class="token string">'yes'</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-else">else</span> available<span class="token operator">=</span><span class="token string">'no'</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    orange pink violet yellow
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre><h3 id="不同数组间的判断">不同数组间的判断 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* 用临时数组保存5科考试的及格分数，读取学生成绩，然后与这些及格分数进行比较，统计学生的及格科目数。*/</span>
<span class="token step keyword">data</span> passing<span class="token punctuation">;</span>
     <span class="token keyword keyword-array">array</span> Pass<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> _TEMPORARY_ <span class="token punctuation">(</span><span class="token number">65</span> <span class="token number">70</span> <span class="token number">65</span> <span class="token number">80</span> <span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword keyword-array">array</span> Score<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     input ID <span class="token punctuation">$</span> Score<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
     Pass_Num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
     <span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> Score<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> Pass<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword keyword-then">then</span> Pass_Num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
     <span class="token keyword keyword-drop">drop</span> i<span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
    001 64 69 68 82 74
    002 80 80 80 60 80
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h2 id="select-when语句"><code>select-when</code>语句 </h2>
<h3 id="select-when使用说明"><code>select-when</code>使用说明 </h3>
<ul>
<li>当一个特殊条件为真时，执行对应<code>when</code>语句，如果所有<code>when</code>条件均不成立，选择执行<code>otherwise</code>语句，用<code>end</code>结束。</li>
<li>知道明确的离散选择项时使用，允许SAS去执行几个语句或者语句组中的一个。</li>
</ul>
<h3 id="案例-简单的单变量判断">案例: 简单的单变量判断 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-select">select</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-otherwise">otherwise</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
</code></pre><h3 id="案例-使用do-end执行复杂语句组">案例: 使用<code>do-end</code>执行复杂语句组 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-select">select</span> <span class="token punctuation">(</span>payclass<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token string">'monthly'</span><span class="token punctuation">)</span> amt<span class="token operator">=</span>salary<span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token string">'hourly'</span><span class="token punctuation">)</span>
      <span class="token keyword keyword-do">do</span><span class="token punctuation">;</span>
         amt<span class="token operator">=</span>hrlywage<span class="token operator">*</span><span class="token function keyword">min</span><span class="token punctuation">(</span>hrs<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword keyword-if">if</span> hrs<span class="token operator">&gt;</span><span class="token number">40</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-put">put</span> <span class="token string">'CHECK TIMECARD'</span><span class="token punctuation">;</span>
      <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>         <span class="token comment">/* end of do     */</span>
   <span class="token keyword keyword-otherwise">otherwise</span> <span class="token keyword keyword-put">put</span> <span class="token string">'PROBLEM OBSERVATION'</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>               <span class="token comment">/* end of select */</span>
</code></pre><h3 id="案例-在when中使用复合表达式">案例: 在<code>when</code>中使用复合表达式 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-select">select</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>mon <span class="token operator-keyword operator">in</span> <span class="token punctuation">(</span><span class="token string">'JUN'</span><span class="token punctuation">,</span> <span class="token string">'JUL'</span><span class="token punctuation">,</span> <span class="token string">'AUG'</span><span class="token punctuation">)</span> <span class="token keyword keyword-and">and</span> <span class="token keyword keyword-temp">temp</span><span class="token operator">&gt;</span><span class="token number">70</span><span class="token punctuation">)</span> <span class="token keyword keyword-put">put</span> <span class="token string">'SUMMER '</span> mon<span class="token operator">=</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>mon <span class="token operator-keyword operator">in</span> <span class="token punctuation">(</span><span class="token string">'MAR'</span><span class="token punctuation">,</span> <span class="token string">'APR'</span><span class="token punctuation">,</span> <span class="token string">'MAY'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-put">put</span> <span class="token string">'SPRING '</span> mon<span class="token operator">=</span><span class="token punctuation">;</span>
   <span class="token keyword keyword-otherwise">otherwise</span> <span class="token keyword keyword-put">put</span> <span class="token string">'FALL OR WINTER '</span> mon<span class="token operator">=</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
</code></pre><h2 id="continue与leave语句"><code>continue</code>与<code>leave</code>语句 </h2>
<h3 id="continue与leave使用说明"><code>continue</code>与<code>leave</code>使用说明 </h3>
<ul>
<li><code>continue</code>语句：停止当前这次循环过程，并继续进行下一次循环过程。</li>
<li><code>Leave</code>语句：停止当前整个<code>do</code>组循环或<code>select</code>组的处理过程，并用跟在<code>do</code>组或<code>select</code>组后面的下一个语句继续执行data步。</li>
</ul>
<h3 id="案例使用continue跳过当前循环">案例：使用<code>continue</code>跳过当前循环 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> zzz<span class="token punctuation">;</span>
    <span class="token keyword keyword-drop">drop</span> i<span class="token punctuation">;</span>
    <span class="token keyword keyword-do">do</span> i<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword keyword-to">to</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token input"><span class="token input keyword">input</span> name $ idno  status $;</span>
        <span class="token keyword keyword-if">if</span>  status<span class="token operator">=</span><span class="token string">'PT'</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-continue">continue</span> <span class="token punctuation">;</span>
        <span class="token input"><span class="token input keyword">input</span> benefits $<span class="token number">10</span>.;</span>
        <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
Jones     9011   PT
Thomas    876    PT
Richards  1002   FT
Eye/Dental
Kelly     85111  PT
Smith     433    FT
HMO
<span class="token punctuation">;</span></span>
<span class="token comment">/*
i  name    idno  status  benefits
3 Richards 1002    FT    Eye/Dental
5 Smith     433    FT    HMO
*/</span>

</code></pre><h3 id="案例使用leave跳出整个循环">案例：使用leave跳出整个循环 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> week<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> name $ idno  start;</span>
    bonus<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">/* from start to year add 50 every year */</span>
    <span class="token keyword keyword-do">do</span> year<span class="token operator">=</span>start <span class="token keyword keyword-to">to</span> <span class="token number">1991</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> bonus <span class="token operator-keyword operator">ge</span> <span class="token number">500</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-leave">leave</span><span class="token punctuation">;</span>
        <span class="token comment">/* 如果在do循环里是类似累加，循环进行到exit+1 */</span>
        bonus<span class="token operator">+</span><span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
    Jones     9011  1990
    Thomas    876   1976
    Barnes    7899  1991
    Harrell   1250  1975
    Richards  1002  1990
    Kelly     85    1981
    Stone     091   1990
<span class="token punctuation">;</span></span>

<span class="token comment">/*
name      idno  start  bonus  year
Jones     9011  1990    100   1992
Thomas    876   1976    500   1986
Barnes    7899  1991     50   1992
Harrell   1250  1975    500   1985
Richards  1002  1990    100   1992
Kelly     85    1981    500   1991
Stone     091   1990    100   1992
*/</span>
</code></pre><h2 id="link与goto语句"><code>link</code>与<code>goto</code>语句 </h2>
<h3 id="link与goto使用说明"><code>link</code>与<code>goto</code>使用说明 </h3>
<ul>
<li><code>goto label</code>语句：
<ul>
<li>立即转到所指示的语句，并从那个语句开始执行后面的语句。</li>
<li><code>label</code>规定语句标号来指示<code>goto</code>的目标。</li>
</ul>
</li>
<li><code>link label</code>语句：
<ul>
<li>立即转到由<code>label</code>语句指示的位置，并从那里开始继续执行语句。</li>
<li>标签内的<code>return</code>语句让SAS立即返回到<code>link</code>语句后面的那个语句并从那里继续执行。</li>
</ul>
</li>
</ul>
<h3 id="案例使用goto转到指定语句">案例：使用<code>goto</code>转到指定语句 </h3>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">data</span> info<span class="token punctuation">;</span>
    input x <span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-file">file</span> <span class="token keyword keyword-print">print</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token number">1</span> <span class="token operator">&lt;=</span> x <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-goto">goto</span> ok<span class="token punctuation">;</span>
    <span class="token comment">/* 不属于if的执行 */</span>
    <span class="token keyword keyword-put">put</span> x<span class="token punctuation">;</span>
    <span class="token comment">/* 不属于if的执行 */</span>
    count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">/* 这句一直要执行 */</span>
    ok: y <span class="token operator">+</span> x<span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
    7 2 16 5 323 1 11
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x   count  y
7    1     7
2    1     9
16   2    25
5    2    30
323  3   353
1    3   354
11   4   365

put:
7
16
323
11
*/</span>

</code></pre><h3 id="案例使用带return语句的link">案例：使用带return语句的<code>link</code> </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> demo<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> type $ wd station $ ;</span>
        elev<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> type<span class="token operator">=</span><span class="token string">'ALUV'</span> <span class="token keyword keyword-then">then</span> link calcu<span class="token punctuation">;</span>

        year<span class="token operator">=</span><span class="token number">1985</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span> <span class="token comment">/* 返回到data步开头 */</span>

        calcu:
        <span class="token keyword keyword-if">if</span> station<span class="token operator">=</span><span class="token string">'SITE_1'</span> <span class="token keyword keyword-then">then</span> elev<span class="token operator">=</span><span class="token number">6650</span><span class="token operator">-</span>wd<span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> station<span class="token operator">=</span><span class="token string">'SITE_2'</span> <span class="token keyword keyword-then">then</span> elev<span class="token operator">=</span><span class="token number">5500</span><span class="token operator">-</span>wd<span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span> <span class="token comment">/* 返回到link语句的下面 */</span>

    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
    ALUV  523  SITE_1
    UPPA  234  SITE_2
    ALUY  666   SITE_2
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
type  wd  station  elev   year
ALUV  523  SITE_1  6127  1985
UPPA  234  SITE_2     .  1985
ALUY  666  SITE_2     .  1985
*/</span>
</code></pre><h2 id="output与return语句"><code>output</code>与<code>return</code>语句 </h2>
<h3 id="output与return使用说明"><code>output</code>与<code>return</code>使用说明 </h3>
<ul>
<li>data步的隐式输出：
<ul>
<li>每个data步最后都执行一个隐式的输出语句将PDV中的数据写入数据集。</li>
</ul>
</li>
<li>data步的显示输出：
<ul>
<li><code>output</code>语句：将当前观测值写入正在建立的数据集中，继续执行后续语句，但整个data步隐式循环不再执行最后的隐式输出，只会清空PDV的变量为缺失。</li>
<li><code>return</code>语句：不执行后续的语句，输出当前PDV观测，然后返回到data步开头继续进行下一轮data步循环。</li>
</ul>
</li>
</ul>
<h3 id="案例使用return停止后续语句">案例：使用<code>return</code>停止后续语句 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/* return 不再执行后续语句，但下一轮data步循环会执行隐式输出 */</span>
<span class="token step keyword">data</span> survey1<span class="token punctuation">;</span>
   <span class="token input"><span class="token input keyword">input</span> x y z;</span>
   <span class="token keyword keyword-if">if</span> x<span class="token operator">=</span>y <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span>
   x<span class="token operator">=</span>y<span class="token operator">+</span>z <span class="token punctuation">;</span>
   a<span class="token operator">=</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
   1  1   3
   2  3   3
<span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x  y  z  a
1  1  3  .
6  3  3 36
*/</span>

<span class="token comment">/* output会继续执行后续语句，整个data步隐式循环不在执行隐式输出 */</span>
<span class="token step keyword">data</span> survey2<span class="token punctuation">;</span>
   <span class="token input"><span class="token input keyword">input</span> x y z;</span>
   <span class="token keyword keyword-if">if</span> x<span class="token operator">=</span>y <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
   x<span class="token operator">=</span>y<span class="token operator">+</span>z <span class="token punctuation">;</span>
   a<span class="token operator">=</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
   1  1   3
   2  3   3
<span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x  y  z  a
1  1  3  .
*/</span>

</code></pre><h3 id="案例使用将不同的观测数据输出到同一行">案例：使用将不同的观测数据输出到同一行 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> a<span class="token punctuation">;</span>
    input x y<span class="token punctuation">@</span><span class="token punctuation">@</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
    1  10
    1  20
    1  200
    2  30
    2  40
    3  50
    3  60
    3  80
    4  70
    4  400
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">a</span><span class="token punctuation">;</span></span> <span class="token keyword keyword-by">by</span> x<span class="token punctuation">;</span> <span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> res<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> a<span class="token punctuation">;</span>
    <span class="token keyword keyword-by">by</span> x<span class="token punctuation">;</span>
    <span class="token comment">/* 如不用retain，下面的put能输出正确的值，但是运行到run后会自动清空，这样output的结果集中rt都会为缺失值 */</span>
    <span class="token keyword keyword-retain">retain</span> rt<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> first<span class="token punctuation">.</span>x <span class="token keyword keyword-then">then</span> rt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> last<span class="token punctuation">.</span>x <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    rt <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token keyword keyword-put">put</span> rt<span class="token operator">=</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
x    y  rt
1  200  20
2   40  30
3   80  60
4  400  70
*/</span>
</code></pre><h2 id="proc-sort过程"><code>proc sort</code>过程 </h2>
<h3 id="proc-sort使用说明"><code>proc sort</code>使用说明 </h3>
<ul>
<li><code>descending</code>表示该选项之后的一个变量按降序对记录排序；若省略引选项，则按默认升序对记录排序。</li>
<li>可在过程不中添加其他通用语句(<code>where</code>)。</li>
<li>如果原数据集已经排序，则不会重复执行 <code>proc sort</code>操作。</li>
<li>数据集比较大的时候该条语句排序剔重比用 <code>distinct</code>更快。</li>
<li>其他DATA步或PROC步只用了<code>by</code>语句，则必须提前进行排序。</li>
</ul>
<h3 id="只保留没有重复的观测">只保留没有重复的观测 </h3>
<ul>
<li><code>uniqueout=</code>：输出关于by变量的观测数据唯一的部分，即没有重复的数据。</li>
</ul>
<h3 id="对数据集进行去重">对数据集进行去重 </h3>
<ul>
<li><code>nodupkey</code>：删除重复的<code>by</code>变量记录。</li>
<li><code>noduprecs/nodup</code>：发生在排序后，所有变量进行比对，将完全相同的记录删除。</li>
<li><code>dupout=</code>：指定一个去重后的数据集。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sashelp.class</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">res</span><span class="token number">1</span> <span class="token arg keyword">nodupkey</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sashelp.class</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">res</span><span class="token number">2</span> <span class="token arg keyword">nodup</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="获取数据集中重复的观测">获取数据集中重复的观测 </h3>
<ul>
<li><code>nouniquekey</code>：保留对于<code>by</code>变量有多条观测的数据。</li>
</ul>
<h3 id="使用key语句对整体变量设置倒序">使用<code>key</code>语句对整体变量设置倒序 </h3>
<ul>
<li>在语法上<code>key</code>和<code>by</code>是互相替代的语句。</li>
</ul>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token comment">/* by语句必须逐个变量指定倒序，key语句可以整体统一设置 */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sortVar</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">sortedOutput</span><span class="token punctuation">;</span></span>
    key x1 x2 <span class="token operator">/</span> descending<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* key语句可以设定正序, by语句不可 */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sortVar</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">sortedOutput</span><span class="token punctuation">;</span></span>
    key x1 <span class="token operator">/</span> ascending<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* key可以多重使用，排序是按照key出现的顺序排变量的 */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sortKeys</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">sortedOutput</span><span class="token punctuation">;</span></span>
    key x2<span class="token punctuation">;</span>
    key x3<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* 无论是by还是key，都可以使用简写变量的方式 */</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sortKeys</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">sortedOutput</span><span class="token punctuation">;</span></span>
    key x1 x2<span class="token operator">-</span>x4<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h2 id="proc-format过程"><code>proc format</code>过程 </h2>
<h3 id="proc-format使用说明"><code>proc format</code>使用说明 </h3>
<ul>
<li><code>value</code>语句
<ul>
<li>其他类型转换为<strong>字符型</strong>，且字符→字符，则需要用<code>$</code>。</li>
<li>主要与<code>put(x,format)</code>连用。</li>
</ul>
</li>
<li><code>invalue</code>语句
<ul>
<li>其他类型转换为<strong>数值型</strong>，且字符→数字，则需要用<code>$</code>。</li>
<li>主要与<code>input(x,informat)</code>连用。</li>
</ul>
</li>
<li><code>picture</code>语句
<ul>
<li>将值映射到一种具体的数值模板上。</li>
</ul>
</li>
<li>在format过程步中使用选项时，要将选项放置到括号<code>(options)</code>中。</li>
</ul>
<h3 id="设置format的范围值">设置format的范围值 </h3>
<ol>
<li>若要赋值的range是不止一个具体的值，用逗号（字符型）将他们隔开，字符型变量的值必须放在引号内；</li>
<li>范围端点为有限值，且包含有限值：用短横线<code>-</code>表示连续的范围，也可表示字符；<br>
举例：0-1，1-100，-1-6；</li>
<li>范围端点包含无限值（正无穷或负无穷）：关键词<code>low</code>和<code>high</code>表示变量的最大值和最小值；<br>
举例：0-high, low-0, low-high；</li>
<li>范围端点为有限值，但不包含有限值：用<code>&lt;-</code>  <code>-&lt;</code>来表示不包括范围的结尾值，<code>&lt;</code>在哪边表示不包括哪边的界限；<br>
举例：0&lt;-1, 1-&lt;100, -1&lt;-&lt;6；</li>
<li>可用关键词<code>other</code>给未分配的值分配格式；</li>
<li>用<code>.</code>表示缺失：无论数值还是字符都只能使用<code>.</code> ，不能使用<code>""</code></li>
<li>用<code>_same_</code>表示给的值保持原始值不变；</li>
</ol>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    value gender <span class="token comment">/*数值型*/</span>
        <span class="token number">1</span><span class="token operator">=</span><span class="token string">'Male'</span>
        <span class="token number">2</span><span class="token operator">=</span><span class="token string">'Female'</span><span class="token punctuation">;</span>
    value <span class="token punctuation">$</span>sexf <span class="token comment">/*字符型 加$符号,*/</span>
        F<span class="token operator">=</span><span class="token string">"女性"</span>
        M<span class="token operator">=</span><span class="token string">"男性"</span><span class="token punctuation">;</span>
    value agegroup <span class="token comment">/*数值范围*/</span>
        <span class="token number">0</span><span class="token operator">-</span><span class="token number">18</span> <span class="token operator">=</span> <span class="token string">'0 to 18'</span>
        <span class="token number">19</span><span class="token operator">-</span><span class="token number">25</span><span class="token operator">=</span> <span class="token string">'19 to 25'</span>
        <span class="token number">26</span><span class="token operator">-</span><span class="token number">49</span> <span class="token operator">=</span><span class="token string">'26 to 49'</span>
        <span class="token number">50</span><span class="token operator">-</span>high<span class="token operator">=</span> <span class="token string">'50+'</span><span class="token punctuation">;</span>
    value agegrp <span class="token comment">/*数值范围,&lt;在哪边就是不包括哪边*/</span>
        <span class="token number">13</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">20</span><span class="token operator">=</span><span class="token string">'Teen'</span>
        <span class="token number">20</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">65</span><span class="token operator">=</span><span class="token string">'Adult'</span>
        <span class="token number">65</span><span class="token operator">-</span>high<span class="token operator">=</span><span class="token string">'Senior'</span><span class="token punctuation">;</span>
    value <span class="token punctuation">$</span> color <span class="token comment">/*字符型变量加$符号*/</span>
        <span class="token string">'W'</span><span class="token operator">=</span><span class="token string">'Moon White'</span>
        <span class="token string">'B'</span><span class="token operator">=</span><span class="token string">'SKy Blue'</span>
        <span class="token string">'Y'</span><span class="token operator">=</span><span class="token string">'Sunburst Yellow'</span>
        <span class="token string">'G'</span><span class="token operator">=</span><span class="token string">'Rain cloud Gray'</span><span class="token punctuation">;</span>
    value  <span class="token punctuation">$</span> typ  <span class="token comment">/*多选项*/</span>
        <span class="token string">'bio'</span><span class="token punctuation">,</span><span class="token string">'non'</span><span class="token punctuation">,</span><span class="token string">'ref'</span><span class="token operator">=</span><span class="token string">'Non-Fiction'</span>
        <span class="token string">'fic'</span><span class="token punctuation">,</span><span class="token string">'mys'</span><span class="token punctuation">,</span><span class="token string">'sci'</span><span class="token operator">=</span><span class="token string">'Fiction'</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="使用defaultn选项处理format截断">使用<code>(default=n)</code>选项处理format截断 </h3>
<ul>
<li>以系统内定值为最长的描述格式或数值标签的长度。n为指定的变量长度，一般为200；</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    <span class="token comment">/* 如果不设置format的长度，则会自动取当前的format value的最大值:'Cycle1 Day 28'，14个字符 */</span>
    value <span class="token punctuation">$</span>avtx
        <span class="token string">'week 1'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 1'</span>
        <span class="token string">'week 2'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 8'</span>
        <span class="token string">'week 3'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 15'</span>
        <span class="token string">'week 4'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 28'</span><span class="token punctuation">;</span>
    <span class="token comment">/* 定义了format长度，就不会存在截断的情况 */</span>
    value <span class="token punctuation">$</span>avtxd <span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
        <span class="token string">'week 1'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 1'</span>
        <span class="token string">'week 2'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 8'</span>
        <span class="token string">'week 3'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 15'</span>
        <span class="token string">'week 4'</span><span class="token operator">=</span><span class="token string">'cycle 1 day 28'</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> avt2<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> avt<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> avisit<span class="token operator">=</span><span class="token string">'week 11'</span> <span class="token keyword keyword-then">then</span> avisit<span class="token operator">=</span><span class="token string">'cycle 3 day 15 pre-dose'</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-length">length</span> avisit2 <span class="token punctuation">$</span><span class="token number">200</span><span class="token punctuation">;</span>
    avisit2<span class="token operator">=</span><span class="token function keyword">put</span><span class="token punctuation">(</span>avisit<span class="token punctuation">,</span> <span class="token punctuation">$</span>avtx<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    avisit2d<span class="token operator">=</span><span class="token function keyword">put</span><span class="token punctuation">(</span>avisit<span class="token punctuation">,</span> <span class="token punctuation">$</span>avtxd<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
avisit                   avisitn       avisit2                      avisit2d
week 1                      1        cycle 1 day 1                cycle 1 day 1
week 2                      2        cycle 1 day 8                cycle 1 day 8
week 3                      3        cycle 1 day 15              cycle 1 day 15
week 4                      4        cycle 1 day 28              cycle 1 day 28
cycle 3 day 15 pre-dose     5        cycle 3 day 15     cycle 3 day 15 pre-dose
*/</span>
</code></pre><h3 id="使用fuzzn选项设置模糊format">使用<code>(fuzz=.n)</code>选项设置模糊format </h3>
<ul>
<li>数字中的小数部分小于等于.n，则匹配相应的format。</li>
<li>如果小数部分大于.n，则只能输出数字的四舍五入整数结果。</li>
</ul>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    value levelsa <span class="token punctuation">(</span>fuzz<span class="token operator">=</span><span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token number">1</span><span class="token operator">=</span><span class="token string">'A'</span>
        <span class="token number">2</span><span class="token operator">=</span><span class="token string">'B'</span>
        <span class="token number">3</span><span class="token operator">=</span><span class="token string">'C'</span>
    value levelsb <span class="token punctuation">(</span>fuzz<span class="token operator">=</span><span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token number">1</span><span class="token operator">=</span><span class="token string">'A'</span>
        <span class="token number">2</span><span class="token operator">=</span><span class="token string">'B'</span>
        <span class="token number">3</span><span class="token operator">=</span><span class="token string">'C'</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> test3<span class="token punctuation">;</span>
    <span class="token input"><span class="token input keyword">input</span> x;</span>
    <span class="token datalines string"><span class="token keyword keyword-cards">cards</span><span class="token punctuation">;</span>
        1.2
        2.3
        3.1
        1.03
        2.15
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> res<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> test3<span class="token punctuation">;</span>
    y <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> levelsa<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    z <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> levelsb<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/* 3.1，小数部分为 0.1 &lt; 0.2，因此匹配上 fuzz=.2，整数部分为 3，所以最后输出为 C */</span>
<span class="token comment">/* 2.3，小数部分为 0.3 &gt; 0.2，因此没有匹配上 fuzz=.2，此时不能匹配为 B，只能输出 2.3 的整数部分 2 */</span>
<span class="token comment">/*
  x     y   z
 1.2    A   A
 2.3    2   B
 3.1    C   C
1.03    A   A
2.15    B   B
*/</span>
</code></pre><h3 id="定义picure的数值模板">定义<code>picure</code>的数值模板 </h3>
<ol>
<li>数值选择符：
<ul>
<li>用于定义数值位置的0-9的字符，1个选择符代表1位数字，通常用数字9来表示非0字符。</li>
<li>如果是非0选择符在最左侧，不足位的数值将会用0补位。</li>
<li>如果是0选择符在最左侧，不足位的数值将不会用0补位。</li>
</ul>
</li>
<li>信息字符：
<ul>
<li>是指非数字字符，直接输出字符串的内容，类似于<code>value</code>语句生成的格式。</li>
<li>可以同时包括数值选择符和信息字符，不过数值字符必须在模板的开头，这样数值选择符的格式才能正常显示。</li>
</ul>
</li>
<li>指令：是一些特殊字符，可以用来格式化日期、时间或日期时间值。</li>
</ol>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    <span class="token comment">/* 数值选择符 */</span>
    picture fmta
        <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token string">'009.9'</span>
        <span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">10</span> <span class="token operator">=</span> <span class="token string">'999.9'</span> <span class="token punctuation">;</span>
    <span class="token comment">/* 信息字符 */</span>
    picture fmtb
        <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token string">'ha'</span>
        <span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">10</span> <span class="token operator">=</span> <span class="token string">'hei'</span> <span class="token punctuation">;</span>
    <span class="token comment">/* 数值选择符和信息字符连用 */</span>
    picture fmtc
        <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token string">'000.00 ha'</span>
        <span class="token number">5</span> <span class="token operator">&lt;</span><span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">=</span> <span class="token string">'999.9 hei'</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> tmp<span class="token punctuation">;</span>
    <span class="token comment">/* 对于1到5之间的数值，保留1位小数；对于5到10之间的数据值，保留1位小数，如果小数点左侧位数小于3位，则用0补位 */</span>
    a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    b1 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmta<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b2 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmtb<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b3 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmtc<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    b1 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmta<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b2 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmtb<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b3 <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmtc<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
a     b1  b2        b3
1    1.0  ha      1.00 ha
10 010.0 hei    010.0 hei
*/</span>
</code></pre><h3 id="对picture数值模板保留小数">对<code>picture</code>数值模板保留小数 </h3>
<ul>
<li><code>(round)</code>对数值进行保留小数位数的操作。
<ul>
<li>未使用<code>Round</code>选项时，对数值进行保留两位小数的操作，会直接取小数位的后两位，不管小数点后第3位数值的大小。</li>
<li>使用<code>Round</code>选项后，对数值进行保留两位小数的操作，会根据小数点后第3位数值的大小进行四舍五入。</li>
</ul>
</li>
</ul>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token comment">**With Round option;</span>
<span class="token step keyword">proc format</span><span class="token punctuation">;</span>
  picture fmt <span class="token punctuation">(</span>round<span class="token punctuation">)</span>
    <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token operator">=</span> <span class="token string">'000.00'</span>
    <span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">10</span> <span class="token operator">=</span> <span class="token string">'999.99 '</span>
  <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> tmp2<span class="token punctuation">;</span>
  a <span class="token operator">=</span> <span class="token number">1.444</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
  a <span class="token operator">=</span> <span class="token number">1.445</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
  a <span class="token operator">=</span> <span class="token number">9.444</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
  a <span class="token operator">=</span> <span class="token number">9.445</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
  a        b
1.444   1.44
1.445   1.45
9.444 009.44
9.445 009.45
*/</span>
</code></pre><h3 id="定义描述统计的输出模板">定义描述统计的输出模板 </h3>
<ul>
<li>通常在输出频数汇总时，频数和频率的输出都是以n (xx.x)的形式输出。
<ol>
<li><code>min =</code>选项指定格式的最小长度。如果不指定长度的话，默认长度是第一条记录format值的长度，这可能造成后续值的截断。</li>
<li><code>round</code>选项：对数值进行四色五入。</li>
<li><code>(Prefix="string")</code>选项：指定一个字符作为格式化模板的前缀。开头的左括号可以通过<code>prefix="( "</code>选项来实现。</li>
<li>特定范围的数值可以使用数值选择符设置特定的格式，后面添加信息字符右括号<code>)</code>。</li>
</ol>
</li>
</ul>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
  picture fmt <span class="token punctuation">(</span>round min <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token number">0</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">99.95</span> <span class="token operator">=</span> <span class="token string">'009.9 )'</span>  <span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"( "</span><span class="token punctuation">)</span>
    <span class="token number">99.95</span><span class="token operator">-</span><span class="token number">100</span> <span class="token operator">=</span> <span class="token string">'999.9 )'</span>  <span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"( "</span><span class="token punctuation">)</span>
  <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">data</span> tmp1<span class="token punctuation">;</span>
    <span class="token comment">/* 使用Picture格式的输出：左括号始终距离数字1个空格 */</span>
    <span class="token comment">/* 手动输出括号的结果：左括号的位置始终固定 */</span>
    a <span class="token operator">=</span> <span class="token number">0.15</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  c <span class="token operator">=</span> <span class="token string">"( "</span> <span class="token operator">||</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5.1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">" ) "</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    a <span class="token operator">=</span> <span class="token number">10.15</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> c <span class="token operator">=</span> <span class="token string">"( "</span> <span class="token operator">||</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5.1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">" ) "</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    a <span class="token operator">=</span> <span class="token number">99.92</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> c <span class="token operator">=</span> <span class="token string">"( "</span> <span class="token operator">||</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5.1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">" ) "</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    a <span class="token operator">=</span> <span class="token number">99.96</span><span class="token punctuation">;</span> b <span class="token operator">=</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> c <span class="token operator">=</span> <span class="token string">"( "</span> <span class="token operator">||</span> <span class="token function keyword">put</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5.1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">" ) "</span><span class="token punctuation">;</span> <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/*
a       b(length=10)   c
0.15      ( 0.2 )  (   0.2 )
10.15    ( 10.2 )  (  10.2 )
99.92    ( 99.9 )  (  99.9 )
99.96   ( 100.0 )  ( 100.0 )
*/</span>

</code></pre><h3 id="picuture进行round的bug处理"><code>picuture</code>进行<code>round</code>的Bug处理 </h3>
<ul>
<li>
<p>当percent=9.96时，<code>put(percent,pcta.)</code>结果为0的问题。</p>
<p>是因为这种数字进行round之后会变成10.0就会有额外的长度，但实际还是用9.96属于0-&lt;10这个区间进行format的mapping。</p>
</li>
</ul>
<ol>
<li>
<p>用额外的data步操作进行手动处理。</p>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    picture <span class="token function keyword">pcta</span><span class="token punctuation">(</span>round<span class="token punctuation">)</span>
        <span class="token number">0</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">10</span>   <span class="token operator">=</span><span class="token string">'9.9)'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' (  '</span><span class="token punctuation">)</span>
        <span class="token number">10</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">100</span><span class="token operator">=</span><span class="token string">'99.9)'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' ( '</span><span class="token punctuation">)</span>
        <span class="token number">100</span>   <span class="token operator">=</span><span class="token string">'999  )'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' ('</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token keyword keyword-if">if</span> <span class="token number">9.95</span> <span class="token operator">&lt;=</span> percent <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword keyword-or">or</span> <span class="token number">99.95</span> <span class="token operator">&lt;=</span> percent <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token keyword keyword-then">then</span> percent <span class="token operator">=</span> <span class="token function keyword">round</span><span class="token punctuation">(</span>percent<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>在picture的range设定中修改范围为9.5/99.95</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc format</span><span class="token punctuation">;</span>
    picture <span class="token function keyword">pcta</span><span class="token punctuation">(</span>round<span class="token punctuation">)</span>
        <span class="token number">0</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">9.5</span>   <span class="token operator">=</span><span class="token string">'9.9)'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' (  '</span><span class="token punctuation">)</span>
        <span class="token number">9.5</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">99.95</span><span class="token operator">=</span><span class="token string">'99.9)'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' ( '</span><span class="token punctuation">)</span>
        <span class="token number">99.95</span>   <span class="token operator">=</span><span class="token string">'999  )'</span> <span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">' ('</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<h3 id="format与数据集的传输"><code>format</code>与数据集的传输 </h3>
<ul>
<li>表中字段要有<code>FMTNAME</code>,<code>START</code>,<code>END</code>,<code>LABEL</code>。
<ul>
<li><code>FMTNAME</code>变量：指定创建的格式名称。如果以<code>$</code>开始，将自动创建character format。</li>
<li><code>START</code>变量：格式范围起始值。</li>
<li><code>END</code>变量：格式范围结束值。</li>
<li><code>LABEL</code>变量：使用format后将会显示的值。</li>
<li><code>TYPE</code>变量：设置informat和format。
<ul>
<li>J：character informat.</li>
<li>I：numeric informat.</li>
<li>C：character format.</li>
<li>N：numeric format.</li>
<li>P：picture format.</li>
</ul>
</li>
<li><code>HLO</code>变量：在数据集中表示上下限，<code>HLO</code>变量的可选值范围：F、H、I、L、N、O、R、S。
<ul>
<li>L表示本条的<code>START</code>变量值是LOW。</li>
<li>H表示本条的<code>END</code>变量值是HIGH。</li>
</ul>
</li>
<li><code>SEXCL</code>变量：在数据集中表示排除起始值，其值可以是Y或N。</li>
<li><code>EEXCL</code>变量：在数据集中表示排除终点值，其值可以是Y或N。</li>
</ul>
</li>
</ul>
<h4 id="数据集转为format">数据集转为<code>format</code> </h4>
<ul>
<li><code>cntlin=SAS表名</code>选项允许我们读入SAS数据集并创建新格式。</li>
</ul>
<pre data-role="codeBlock" data-info="SAS" class="language-sas SAS"><code><span class="token comment">/* 建立了名为scale的数据集，它指定了数值范围和相应的格式 */</span>
<span class="token step keyword">data</span> scale<span class="token punctuation">;</span>
    input begin: <span class="token punctuation">$</span>char2<span class="token punctuation">.</span> <span class="token keyword keyword-end">end</span>: <span class="token punctuation">$</span>char2<span class="token punctuation">.</span> amount: <span class="token punctuation">$</span>char4<span class="token punctuation">.</span><span class="token punctuation">;</span>
    <span class="token datalines string"><span class="token keyword keyword-datalines">datalines</span><span class="token punctuation">;</span>
        0   3    0%
        4   6    3%
        7   8    6%
        9   10   8%
        11  16   10%
    <span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* 添加一些其他需要的格式控制变量设置：加入了other条件的标签值：当数据不取在上面的范围内时，显示格式为"***ERROR***" */</span>
<span class="token step keyword">data</span> ctrl<span class="token punctuation">;</span>
    <span class="token keyword keyword-length">length</span> <span class="token keyword keyword-label">label</span> <span class="token punctuation">$</span><span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> <span class="token function keyword">scale</span><span class="token punctuation">(</span>rename<span class="token operator">=</span> <span class="token punctuation">(</span>begin<span class="token operator">=</span> start amount<span class="token operator">=</span> <span class="token keyword keyword-label">label</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span><span class="token operator">=</span> last<span class="token punctuation">;</span>
    <span class="token keyword keyword-retain">retain</span> fmtname <span class="token string">"PercentageFormat"</span> type <span class="token string">"n"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> last <span class="token keyword keyword-then do">then do</span><span class="token punctuation">;</span>
        hlo<span class="token operator">=</span> <span class="token string">"O"</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-label">label</span><span class="token operator">=</span> <span class="token string">"***ERROR***"</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-output">output</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* 将创建的格式存储在目录 Work.Formats 中，并指定格式的来源 */</span>
<span class="token step keyword">proc format</span> <span class="token proc-args"><span class="token arg keyword">library</span><span class="token operator">=</span> <span class="token arg-value">work</span> <span class="token arg keyword">cntlin</span><span class="token operator">=</span> <span class="token arg-value">ctrl</span><span class="token punctuation">;</span></span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/* 显示percentageformat的格式情况 */</span>
<span class="token step keyword">proc format</span> <span class="token proc-args"><span class="token arg keyword">lib</span><span class="token operator">=</span> <span class="token arg-value">work</span> <span class="token arg keyword">fmtlib</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-select">select</span> percentageformat<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h4 id="format转为数据集"><code>format</code>转为数据集 </h4>
<ul>
<li><code>cntlout=sas表名</code>将formats文件可以转化为SAS数据集的形式存储；</li>
<li>导出的数据集变量含义：
<ul>
<li><code>HLO</code>变量：在输出数据集中表示上下限，<code>L</code>表示本条的start变量值是LOW；<code>H</code>表示本条的end变量值是HIGH。
<ul>
<li><code>HLO</code>变量的可选值范围：F、H、I、L、N、O、R、S。</li>
</ul>
</li>
<li><code>SEXCL</code>变量：在输出文件中表示排除起始值，其值可以是Y或N。</li>
<li><code>EEXCL</code>变量：在输出文件中表示排除终点值，其值可以是Y或N。</li>
</ul>
</li>
</ul>
<h5 id="常规format转为数据集">常规<code>format</code>转为数据集 </h5>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc format</span> <span class="token proc-args"><span class="token arg keyword">library</span><span class="token operator">=</span><span class="token arg-value">work</span> <span class="token arg keyword">cntlout</span><span class="token operator">=</span><span class="token function keyword">psn</span><span class="token punctuation">(</span><span class="token arg keyword">keep</span><span class="token operator">=</span><span class="token arg-value">fmtname</span> <span class="token arg keyword">start</span> <span class="token arg keyword">end</span> <span class="token arg keyword">label</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
    value person <span class="token number">0</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">=</span><span class="token string">'baby'</span>
                <span class="token number">3</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">=</span><span class="token string">'child'</span>
                <span class="token number">13</span><span class="token operator">-</span><span class="token number">19</span><span class="token operator">=</span><span class="token string">'teen'</span>
                <span class="token number">20</span><span class="token operator">-</span><span class="token number">64</span><span class="token operator">=</span><span class="token string">'adult'</span>
                <span class="token number">65</span><span class="token operator">-</span><span class="token number">100</span><span class="token operator">=</span><span class="token string">'senior'</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
fmtname  start  end   label
person    0      2    baby
person    3     12    child
person    13    19    teen
person    20    64    adult
person    65   100    senior
*/</span>
</code></pre><h5 id="带有端点值和无限范围的format转为数据集">带有端点值和无限范围的<code>format</code>转为数据集 </h5>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc format</span> <span class="token proc-args"><span class="token arg keyword">library</span><span class="token operator">=</span><span class="token arg-value">work</span> <span class="token arg keyword">cntlout</span><span class="token operator">=</span><span class="token arg-value">psn</span> <span class="token punctuation">(</span><span class="token arg keyword">keep</span><span class="token operator">=</span><span class="token arg-value">fmtname</span> <span class="token arg keyword">start</span> <span class="token arg keyword">end</span> <span class="token arg keyword">label</span> <span class="token arg keyword">sexcl</span> <span class="token arg keyword">eexcl</span> <span class="token arg keyword">hlo</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
    value person
        low<span class="token operator">-</span><span class="token number">2</span><span class="token operator">=</span><span class="token string">'baby'</span>
        <span class="token number">3</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token number">13</span><span class="token operator">=</span><span class="token string">'child'</span>
        <span class="token number">13</span><span class="token operator">-</span><span class="token number">19</span><span class="token operator">=</span><span class="token string">'teen'</span>
        <span class="token number">20</span><span class="token operator">-</span><span class="token number">64</span><span class="token operator">=</span><span class="token string">'adult'</span>
        <span class="token number">64</span><span class="token operator">&lt;</span><span class="token operator">-</span>high<span class="token operator">=</span><span class="token string">'senior'</span> <span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token comment">/*
fmtname  start  end   label   sexcl   eexcl  hlo
person    LOW    2    baby     N        N     L
person    3     12    child    N        Y
person    13    19    teen     N        N
person    20    64    adult    N        N
person    65   HIGH    senior  Y        N     H
*/</span>
</code></pre><h2 id="proc-report过程"><code>proc report</code>过程 </h2>
<h3 id="基本语句">基本语句 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"~"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> listing <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> rtf <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"/home/pic0xxd/test.rtf"</span> style<span class="token operator">=</span>global<span class="token punctuation">.</span>rtf operator<span class="token operator">=</span><span class="token string">"~{\dntblnsbdb}"</span><span class="token punctuation">;</span>

<span class="token keyword keyword-title6">title6</span> j<span class="token operator">=</span>l <span class="token string">"#byval2"</span><span class="token punctuation">;</span>
<span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sashelp.class</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">class</span><span class="token punctuation">;</span></span> <span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span> <span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">class</span> <span class="token arg keyword">nowd</span> <span class="token arg keyword">split</span><span class="token operator">=</span><span class="token string">"~"</span> <span class="token arg keyword">headline</span> <span class="token arg keyword">headskip</span> <span class="token arg keyword">missing</span> <span class="token arg keyword">spacing</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token function keyword">style</span><span class="token punctuation">(</span><span class="token arg keyword">report</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token arg keyword">protectspecialchars</span> <span class="token operator">=</span> <span class="token arg-value">off</span> <span class="token arg keyword">asis</span> <span class="token operator">=</span> <span class="token arg-value">on</span><span class="token punctuation">]</span>
        <span class="token function keyword">style</span><span class="token punctuation">(</span><span class="token arg keyword">header</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token arg keyword">just</span><span class="token operator">=</span><span class="token arg-value">l</span> <span class="token arg keyword">protectspecialchars</span><span class="token operator">=</span><span class="token arg-value">off</span> <span class="token arg keyword">asis</span><span class="token operator">=</span><span class="token arg-value">on</span><span class="token punctuation">]</span>
        <span class="token function keyword">style</span><span class="token punctuation">(</span><span class="token arg keyword">column</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token arg keyword">just</span><span class="token operator">=</span><span class="token arg-value">l</span> <span class="token arg keyword">protectspecialchars</span><span class="token operator">=</span><span class="token arg-value">off</span> <span class="token arg keyword">asis</span><span class="token operator">=</span><span class="token arg-value">on</span><span class="token punctuation">]</span>
        <span class="token function keyword">style</span><span class="token punctuation">(</span><span class="token arg keyword">lines</span><span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token arg keyword">outputwidth</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">%</span> <span class="token arg keyword">protectspecialchars</span><span class="token operator">=</span><span class="token arg-value">off</span> <span class="token arg keyword">asis</span><span class="token operator">=</span><span class="token arg-value">on</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-column">column</span> sex <span class="token keyword keyword-name">name</span> age height weight<span class="token punctuation">;</span>
        <span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> sex <span class="token operator">/</span> order flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> <span class="token keyword keyword-name">name</span> <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> age <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> height <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> weight <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    break <span class="token keyword keyword-after">after</span> sex <span class="token operator">/</span> page<span class="token punctuation">;</span>
    <span class="token keyword keyword-compute">compute</span> before sex<span class="token punctuation">;</span>
        line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">" "</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-endcomp">endcomp</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> rtf <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> listing<span class="token punctuation">;</span>
</code></pre><h3 id="ods语句相关说明"><code>ods</code>语句相关说明 </h3>
<ul>
<li>
<p>指定转义字符</p>
<p><code>ods escapechar="~";</code></p>
</li>
<li>
<p>先开后关，后开先关</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code>ods listing <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
ods rtf <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"xxx.rtf"</span><span class="token punctuation">;</span>


ods rtf <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
ods listing<span class="token punctuation">;</span>
</code></pre></li>
<li>
<p>output对齐的ods选项</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code>ods rtf <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"test.rtf"</span> operator<span class="token operator">=</span><span class="token string">"{\jexpand\dntblnsbdb}"</span><span class="token punctuation">;</span>
</code></pre></li>
</ul>
<h3 id="过程步options">过程步options </h3>
<table>
<thead>
<tr>
<th>常用选项</th>
<th>选项的作用</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nowd</code>(nowindows)</td>
<td>将结果显示到输出窗口和结果查看器窗口，如果不加该选项，绝大多数情况下加上该选项。</td>
<td>无，默认输出到一个新的报表窗口，不方便查看。</td>
</tr>
<tr>
<td><code>headline</code></td>
<td>在表头下方显示一条分割线，使表头与下方数值分隔开。</td>
<td>无</td>
</tr>
<tr>
<td><code>headskip</code></td>
<td>在所有列标题下面或横线(HEADSKIP)下面写一个空行。</td>
<td>无</td>
</tr>
<tr>
<td><code>split=</code></td>
<td>指定label的分隔符，与ods escapechar无关。</td>
<td>/</td>
</tr>
<tr>
<td><code>box</code></td>
<td>生成的表格包含所有的横竖框线。</td>
<td>无，没有任何框线</td>
</tr>
<tr>
<td><code>showall</code></td>
<td>强制所有column中出现的列都输出，即使define后面的选项是noprint! 据说这是一个debug的好工具，便于查看有时候group和order的变量为什么不起作用。但是工作中不常用。</td>
<td></td>
</tr>
<tr>
<td><code>center</code>|<code>nocenter</code></td>
<td>center: 输出的列都是居中。
nocenter:输出的列都是左对齐。</td>
<td>center</td>
</tr>
<tr>
<td><code>list</code></td>
<td>输出proc report输出报告时对各列配置的属性，包括宽度，对齐方式等。一般到后面我们会手动给各列设置长度。</td>
<td></td>
</tr>
<tr>
<td><code>noheader</code></td>
<td>不输出列标题，一般在用两个proc report的时候，不想输出第二个report的标题就可以加这个选项，但是工作中输出listing每页都得输出列标题。所以不常用。</td>
<td></td>
</tr>
<tr>
<td><code>missing</code></td>
<td>对于变量值中有缺失值的，也当作一个值输出（只对order,group,across选项的值有效），这个必须添加，因为工作中肯定会遇到缺失值。如果某个变量全部是缺失值，会报这个warning。<code>Warning: A GROUP, ORDER, or ACROSS variable is missing on every observation.</code></td>
<td>不显示缺失值
</td>
</tr>
</tbody>
</table>
<h3 id="column语句"><code>column</code>语句 </h3>
<h4 id="基本原则">基本原则 </h4>
<ul>
<li>指定输出的一个或多个变量，控制变量在输出中的顺序。</li>
<li>当指定的变量均为字符型时，会输出所有指定变量的每一条观测；</li>
<li>当指定的变量均为数值型时，仅输出指定数值变量的总和，而不是每一条观测；</li>
<li>当指定的变量既有数值变量又有字符变量时，输出指定变量的每一条观测；</li>
</ul>
<h4 id="多层表头">多层表头 </h4>
<ul>
<li>方法一：中间会连接到一起<br>
其中的"<code>^</code>"通过<code>ods escapechar</code>指定，不能与<code>proc report</code>中<code>split=</code>选项指定的符号相同。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-column">column</span> sex <span class="token keyword keyword-name">name</span> age
        <span class="token punctuation">(</span><span class="token string">"^S={borderleftcolor=white
            borderrightcolor=white
            borderbottomcolor=black
            borderbottomwidth=.05} BMI info"</span>
        height weight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>方法二：中间不会连接到一起<br>
其中的"<code>^</code>"通过<code>proc report</code>中<code>split=</code>选项指定。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token macro-keyword keyword">%let</span> line1<span class="token operator">=</span><span class="token macro-keyword keyword">%sysfunc</span><span class="token punctuation">(</span><span class="token function keyword">repeat</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-column">column</span> sex <span class="token keyword keyword-name">name</span> age <span class="token punctuation">(</span><span class="token string">"BMI info~&amp;line1."</span> height weight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h3 id="where语句"><code>where</code>语句 </h3>
<p>用于筛选数据</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-proc">proc</span> report <span class="token keyword keyword-data">data</span><span class="token operator">=</span>sashelp<span class="token punctuation">.</span>class<span class="token punctuation">;</span>
    <span class="token keyword keyword-where">where</span> sex<span class="token operator">=</span><span class="token string">'F'</span> <span class="token operator">and</span> weight <span class="token operator">&gt;</span> <span class="token number">70</span><span class="token punctuation">;</span>
run<span class="token punctuation">;</span>
</code></pre><h3 id="define语句"><code>define</code>语句 </h3>
<p>为单个变量指定特定的options。</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-DEFINE">DEFINE</span> variable <span class="token operator">/</span> <span class="token operator">&lt;</span><span class="token function keyword">option</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span>  <span class="token operator">&lt;</span><span class="token string">'column-heading'</span><span class="token operator">&gt;</span> <span class="token punctuation">;</span>
</code></pre><table>
<thead>
<tr>
<th>常用选项</th>
<th>选项的作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>format=</code></td>
<td>指定数值型变量的显示格式</td>
</tr>
<tr>
<td><code>n,mean</code>,<code>std</code>,<code>median</code>,
<code>q1</code>,<code>min</code>,<code>max</code>...</td>
<td>各种统计量</td>
</tr>
<tr>
<td><code>width=</code></td>
<td>指定列宽，默认宽度：字符-变量长度，数值-9</td>
</tr>
<tr>
<td><code>spacing=</code></td>
<td>指定选定列和紧接其左侧的列之间的空白字符。默认为2</td>
</tr>
<tr>
<td><code>center</code>,<code>left</code>,<code>right</code></td>
<td>表格中数据对齐方式；默认：数值-右对齐，字符-左对齐。如果在<code>style(column)={}</code>中定义了居中等格式，此选项不起作用。</td>
</tr>
<tr>
<td><code>id</code></td>
<td>指定变量将会在每一个显示出来。可以实现同一个subject折页显示不同变量。</td>
</tr>
<tr>
<td><code>page</code></td>
<td>用于在指定的列开始新的页面。可以配合<code>id</code>选项实现折页。</td>
</tr>
<tr>
<td><code>flow</code></td>
<td>变量长度超过定义的宽带之后，自动换行显示。</td>
</tr>
<tr>
<td>'column-heading'</td>
<td>指定列标题的标签，超过列宽会自动换行，也可通过<code>split=</code>指定的分隔符。</td>
</tr>
<tr>
<td>变量的显示方式</td>
<td>变量的显示方式有6种。</td>
</tr>
</tbody>
</table>
<ul>
<li>6种变量显示方式
<ol>
<li>
<p><code>display</code></p>
<ul>
<li>显示每一条观测，字符变量默认用法。</li>
</ul>
</li>
<li>
<p><code>analysis</code></p>
<ul>
<li>指定变量为分析变量，并指定统计量（默认<code>sum</code>），数值型变量的默认用法。</li>
</ul>
</li>
<li>
<p><code>order</code></p>
<ul>
<li>指定变量为顺序变量，相同变量值，只显示一个，显示每一条观测。</li>
<li>并且这些行按顺序(升序)排列，<code>descending</code>(降序)。生成listing  report。</li>
<li>可以在<code>order</code>中定义选项：
<ul>
<li><code>order=data</code>: 排序规则为数据集中所有观测值的出现顺序。</li>
<li><code>order=interval</code>: 排序规则为数据集中原本的顺序。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>group</code></p>
<ul>
<li>(汇总)指定变量为分组变量，为变量的每个唯一值创建一行。生成summary report。</li>
<li>column中所有字符变量均为分组变量时，默认生成column中其他数值型变量的统计量（默认SUM）。</li>
<li>如果需要显示其他统计量，可以使用define语句对数值型变量进行指定。</li>
</ul>
</li>
<li>
<p><code>across</code></p>
<ul>
<li>(频数)为变量的每个唯一值创建一列，产生列分组。</li>
<li>ACROSS的变量生成频数值（COUNT），其他数值型变量则显示sum统计量。</li>
</ul>
</li>
<li>
<p><code>computed</code></p>
<ul>
<li>输出中添加计算变量。</li>
<li>通过计算创建新变量<code>new_var</code>，<code>new_var</code>需要在<code>column</code>语句中。</li>
<li>如果计算中使用到了其他变量<code>other_var</code>，那么在<code>column</code>语句中<code>other_var</code>要写在<code>new_var</code>的前面。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token comment">/*输出中添加计算变量的格式*/</span>
<span class="token keyword keyword-DEFINE">DEFINE</span> new_var_name <span class="token operator">/</span> <span class="token keyword keyword-COMPUTED">COMPUTED</span><span class="token punctuation">;</span>    <span class="token comment">/*计算块中的新变量，必须添加computed选项*/</span>
<span class="token keyword keyword-COMPUTE">COMPUTE</span> new_var_name <span class="token operator">/</span> <span class="token keyword keyword-options">options</span><span class="token punctuation">;</span>
    statements<span class="token punctuation">;</span>                    <span class="token comment">/*可以是：赋值语句、IF语句、DO循环语句*/</span>
<span class="token keyword keyword-ENDCOMP">ENDCOMP</span><span class="token punctuation">;</span>


<span class="token comment">/*
***计算数值变量***
！！！在COMPUTE语句中定义其变量名
！！！如果用到分析(ANALYSIS)角色变量，则必须将其对应的统计量(默认SUM)放在变量名后。
下面语句生成一个数值计算变量Income，其值为Salary和Bonus的总和。
*/</span>
<span class="token keyword keyword-DEFINE">DEFINE</span> Income <span class="token operator">/</span> <span class="token keyword keyword-COMPUTED">COMPUTED</span><span class="token punctuation">;</span>
<span class="token keyword keyword-COMPUTE">COMPUTE</span> Income<span class="token punctuation">;</span>
    Income <span class="token operator">=</span> Salary<span class="token punctuation">.</span>SUM <span class="token operator">+</span> Bonus<span class="token punctuation">.</span>SUM<span class="token punctuation">;</span>
<span class="token keyword keyword-ENDCOMP">ENDCOMP</span><span class="token punctuation">;</span>


<span class="token comment">/*
***计算字符变量***
！！！在COMPUTE语句中添加“CHAR”选项和“LENGTH”选项指定字符变量长度（1~200，默认8）。
下面语句生成一个字符计算变量JobType。
*/</span>
<span class="token keyword keyword-DEFINE">DEFINE</span> JobType <span class="token operator">/</span> <span class="token keyword keyword-COMPUTED">COMPUTED</span><span class="token punctuation">;</span>
<span class="token keyword keyword-COMPUTE">COMPUTE</span> JobType <span class="token operator">/</span> CHAR <span class="token keyword keyword-LENGTH">LENGTH</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-IF">IF</span> <span class="token keyword keyword-Title">Title</span> <span class="token operator">=</span> <span class="token string">'Programmer'</span> <span class="token keyword keyword-THEN">THEN</span>  JobType <span class="token operator">=</span> <span class="token string">'Technical'</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-ELSE">ELSE</span> JobType <span class="token operator">=</span> <span class="token string">'Other'</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ENDCOMP">ENDCOMP</span><span class="token punctuation">;</span>

</code></pre></li>
</ol>
</li>
</ul>
<h3 id="by语句"><code>by</code>语句 </h3>
<p>按指定的变量分多个表显示(使用前需要先排序)。</p>
<h3 id="byvar的使用"><code>#byvar</code>的使用 </h3>
<ul>
<li>
<p>用法：在proc report制作报表时，按指定变量的分类显示。</p>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code>#<span class="token function keyword">byval</span><span class="token punctuation">(</span>variable<span class="token operator">-</span>name<span class="token punctuation">)</span>
#byval1
#byval2
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></li>
<li>
<p>可以用来添加output的subtitle。</p>
<ul>
<li>首先用<code>proc sort</code>进行排序。</li>
<li>排序后<code>#byvar</code>就可以你用<code>proc sort</code>的<s>by</s>变量，因此也也可以写成<code>#byvar(variablename)</code>。</li>
<li>在<code>proc report</code>中同样使用目标分类显示变量。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sashelp.class</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">temp</span><span class="token punctuation">;</span></span>
<span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token keyword keyword-title1">title1</span> <span class="token string">"Listing of Subject Characteristics"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-title2">title2</span> <span class="token string">"Sex=#byval(sex)"</span><span class="token punctuation">;</span>
<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">nowd</span> <span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">temp</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> sex<span class="token punctuation">;</span>
    <span class="token keyword keyword-column">column</span> <span class="token keyword keyword-name">name</span> height weight<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> <span class="token keyword keyword-name">name</span> <span class="token operator">/</span> <span class="token string">"Patient Name"</span> width<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> height <span class="token operator">/</span> <span class="token string">"Height"</span> width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> weight <span class="token operator">/</span> <span class="token string">"Weight"</span> width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

</code></pre></li>
<li>
<p>多个<code>by</code>变量的处理</p>
<ul>
<li>实际上多个 <code>By</code> 变量不影响，按需使用就行。</li>
<li><code>#byval1 #byval2</code> 这个等价于<code>#byval(origin) #byval(make) ,1,2...</code>是 <code>proc sort</code> 里 <code>by</code> 变量的顺序。</li>
<li><code>"Brand #byval2 From #byval1";</code> 这里面的写法很自由，就相当于我们日常造句，只是使用<code>#byval</code> 语法来动态替代分类变量名。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc sort</span> <span class="token proc-args"><span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">sashelp.cars</span> <span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">cars</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> origin make<span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>

<span class="token keyword keyword-title1">title1</span> <span class="token string">"The weight of Cars By Origin and Make"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-title2">title2</span> <span class="token string">"Brand #byval2 From #byval1"</span><span class="token punctuation">;</span>

<span class="token step keyword">proc report</span> <span class="token proc-args"><span class="token arg keyword">nowd</span> <span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">cars</span><span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> origin make<span class="token punctuation">;</span>
    <span class="token keyword keyword-column">column</span> weight<span class="token punctuation">;</span>
    <span class="token keyword keyword-define">define</span> weight <span class="token operator">/</span> <span class="token string">"Weight"</span> width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre></li>
</ul>
<h3 id="break与rbreak语句"><code>break</code>与<code>rbreak</code>语句 </h3>
<ul>
<li><code>break</code>：可在指定变量的上方(before) 或下方(after) 插入一条分割线， 并显示统计量。</li>
<li><code>rbreak</code>：指定在表格最下方或最上方插入一条分割线， 并显示统计量。</li>
</ul>
<pre data-role="codeBlock" data-info="batch" class="language-batch batch"><code><span class="token command"><span class="token keyword keyword-BREAK">BREAK</span> after variable/options;</span>
<span class="token command"><span class="token keyword keyword-RBREAK">RBREAK</span> before /options;</span>
</code></pre><p>variable：必须是分组(<code>group</code>)变量或者排序(<code>order</code>)变量。</p>
<table>
<thead>
<tr>
<th>常用选项(options)</th>
<th>选项的作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ol</td>
<td>在指定的变量（或表格）上方显示一条单横线作为分割线</td>
</tr>
<tr>
<td>ul</td>
<td>在指定的变量（或表格）下方显示一条单横线作为分割线</td>
</tr>
<tr>
<td>dol</td>
<td>在指定的变量（或表格）上方显示一条双横线作为分割线</td>
</tr>
<tr>
<td>dul</td>
<td>在指定的变量（或表格）下方显示一条双横线作为分割线</td>
</tr>
<tr>
<td>page</td>
<td>开始新的一页</td>
</tr>
<tr>
<td>summarize</td>
<td>在指定的变量（或表格）上方或下方显示指定变量的综合统计量，如break after gender/summarize;，可分别显示男性和女性的统计量</td>
</tr>
<tr>
<td>suppress</td>
<td>当输出指定变量的综合统计量时，不显示该变量的类别名</td>
</tr>
</tbody>
</table>
<h3 id="compute语句"><code>compute</code>语句 </h3>
<p><code>compute</code>语句有两个， 一个与跟<code>line</code>语句合用， 另一个是与<code>call define</code>语句合用。</p>
<h4 id="line语句"><code>line</code>语句 </h4>
<ul>
<li>与<code>line</code>语句合用时， 创建自定义行。</li>
</ul>
<ol>
<li>创建自定义行： LINE语句允许您在报告中插入自定义的文本行，这些行可以包含静态文本、变量值或计算结果。</li>
<li>位置灵活： LINE语句可以在COMPUTE块内使用，因此可以在报告的开始、结束或特定列的计算中插入行。</li>
<li>格式控制： 您可以使用LINE语句控制文本的对齐方式（左对齐、居中、右对齐）和样式。</li>
<li>条件输出： 结合IF-THEN语句，LINE可以根据特定条件输出不同的文本行。</li>
<li>多行输出： 您可以使用多个LINE语句来创建多行输出。</li>
<li>变量引用： 在LINE语句中，您可以引用报告中的列、计算值或其他SAS变量。</li>
</ol>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code>line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"total: "</span> <span class="token punctuation">@</span><span class="token number">10</span> <span class="token punctuation">(</span><span class="token function keyword">put</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> dollar12<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-if">if</span> status <span class="token operator">=</span> <span class="token string">'completed'</span> <span class="token keyword keyword-then">then</span> line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"status: completed"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-else">else</span> line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"status: in progress"</span><span class="token punctuation">;</span>

line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"customer: "</span> <span class="token punctuation">@</span><span class="token number">15</span> <span class="token punctuation">(</span><span class="token function keyword">upcase</span><span class="token punctuation">(</span>customer_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h4 id="call-define语句"><code>call define</code>语句 </h4>
<ul>
<li>与<code>call define</code>语句合用时，可以对表格进行修饰。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token keyword keyword-compute">compute</span> height<span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> height<span class="token operator">&gt;</span><span class="token number">175</span> <span class="token keyword keyword-then">then</span>
    <span class="token keyword keyword-call">call</span> <span class="token keyword keyword-define">define</span>
<span class="token keyword keyword-endcomp">endcomp</span><span class="token punctuation">;</span>
</code></pre><h3 id="footnote显示在第一页">footnote显示在第一页 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">data</span> page_final<span class="token punctuation">;</span>
    <span class="token keyword keyword-set">set</span> listings<span class="token punctuation">.</span><span class="token macro-variable">&amp;TFLNAME</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
    GRPX0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">/* determine page by grouping */</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token comment">/* footnote: refer to the first page */</span>
<span class="token step keyword">proc sql</span> <span class="token proc-args"><span class="token arg keyword">noprint</span><span class="token punctuation">;</span></span><span class="token proc-sql">
<span class="token sql language-sql">    <span class="token keyword keyword-insert">insert</span> <span class="token keyword keyword-into">into</span> page_final<span class="token punctuation">(</span>BYVAR<span class="token punctuation">,</span> GRPXPAG<span class="token punctuation">,</span> GRPX0<span class="token punctuation">)</span> <span class="token keyword keyword-values">values</span><span class="token punctuation">(</span><span class="token string">"^n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token sql language-sql">    <span class="token keyword keyword-create">create</span> <span class="token keyword keyword-table">table</span> final_all <span class="token keyword keyword-as">as</span>
        <span class="token keyword keyword-select">select</span> <span class="token operator">*</span>
        <span class="token keyword keyword-from">from</span> page_final
        <span class="token keyword keyword-order">order</span> <span class="token keyword keyword-by">by</span> GRPX0<span class="token punctuation">,</span> GRPX1<span class="token punctuation">,</span> GRPX2<span class="token punctuation">,</span> GRPX3<span class="token punctuation">,</span> GRPX4<span class="token punctuation">,</span> GRPX5<span class="token punctuation">,</span> GRPX6<span class="token punctuation">,</span> GRPX7<span class="token punctuation">;</span></span>
</span><span class="token step keyword">quit</span><span class="token punctuation">;</span>

<span class="token keyword keyword-ods">ods</span> escapechar<span class="token operator">=</span><span class="token string">"~"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> listing <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> rtf <span class="token keyword keyword-file">file</span><span class="token operator">=</span><span class="token string">"&amp;_olistings.&amp;TFLNAME..rtf"</span> style<span class="token operator">=</span>global<span class="token punctuation">.</span>rtf operator<span class="token operator">=</span><span class="token string">"{\jexpand\dntblnsbdb}"</span><span class="token punctuation">;</span>
<span class="token macro-keyword keyword">%do</span> i<span class="token operator">=</span><span class="token number">0</span> <span class="token macro-keyword keyword">%to</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token step keyword">data</span> final_out<span class="token punctuation">;</span>
        <span class="token keyword keyword-set">set</span> final_all<span class="token punctuation">;</span>
        <span class="token keyword keyword-where">where</span> GRPX0<span class="token operator">=</span><span class="token macro-variable">&amp;i</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
    <span class="token step keyword">run</span><span class="token punctuation">;</span>
    <span class="token macro-keyword keyword">%if</span> <span class="token macro-variable">&amp;i</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-title6">title6</span> j<span class="token operator">=</span>c <span class="token string">" "</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-title7">title7</span> j<span class="token operator">=</span>l <span class="token string">"#byval3"</span><span class="token punctuation">;</span>
    <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
    <span class="token step keyword">proc report</span> <span class="token keyword keyword-data">data</span><span class="token operator">=</span>final_out <span class="token keyword keyword-nowd">nowd</span> split<span class="token operator">=</span><span class="token string">"~"</span> <span class="token keyword keyword-headline">headline</span> <span class="token keyword keyword-headskip">headskip</span> missing spacing<span class="token operator">=</span><span class="token number">1</span>
            <span class="token function keyword">style</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span>protectspecialchars <span class="token operator">=</span> off asis <span class="token operator">=</span> on<span class="token punctuation">]</span>
            <span class="token function keyword">style</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span>just<span class="token operator">=</span>l protectspecialchars<span class="token operator">=</span>off asis<span class="token operator">=</span>on<span class="token punctuation">]</span>
            <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span>just<span class="token operator">=</span>l protectspecialchars<span class="token operator">=</span>off asis<span class="token operator">=</span>on<span class="token punctuation">]</span>
            <span class="token function keyword">style</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span>  <span class="token operator">=</span> <span class="token punctuation">[</span>outputwidth<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">%</span> protectspecialchars<span class="token operator">=</span>off asis<span class="token operator">=</span>on<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%if</span> <span class="token macro-variable">&amp;i</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-column">column</span> GRPXPAG GRPX0 GRPX1 GRPX2 GRPX3<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPXPAG <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX0 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX1 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX2 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX3 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%else</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-column">column</span> GRPXPAG GRPX1 GRPX2 BYVAR GRPX3 COL1<span class="token operator">-</span>COL5<span class="token punctuation">;</span>
                <span class="token keyword keyword-by">by</span> GRPX1 GRPX2 BYVAR<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPXPAG <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> BYVAR <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX1 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX2 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> GRPX3 <span class="token operator">/</span> order noprint<span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> COL1 <span class="token operator">/</span> order flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> COL2 <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> COL3 <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> COL4 <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-define">define</span> COL5 <span class="token operator">/</span> display flow <span class="token function keyword">style</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span>cellwidth<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">%</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
        break <span class="token keyword keyword-after">after</span> GRPXPAG <span class="token operator">/</span> page<span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%if</span> <span class="token macro-variable">&amp;i</span><span class="token punctuation">.</span><span class="token operator">=</span><span class="token number">0</span> <span class="token macro-keyword keyword">%then</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-compute">compute</span> before GRPX3<span class="token operator">/</span>style<span class="token operator">=</span><span class="token punctuation">{</span>just<span class="token operator">=</span>l<span class="token punctuation">}</span><span class="token punctuation">;</span>
                line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">" "</span><span class="token punctuation">;</span>
                line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"ADJ=adjudication, AE=adverse event, AESI=adverse event of special interest, Disc=discontinuation, F=female, M=male,"</span><span class="token punctuation">;</span>
                line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">"N=no, Rel=related, SAE=serious adverse event, SEV=severity, TEAE=treatment-emergent adverse event, Y=yes, yrs=years."</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-endcomp">endcomp</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%else</span> <span class="token macro-keyword keyword">%do</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-compute">compute</span> before GRPX3<span class="token punctuation">;</span>
                line <span class="token punctuation">@</span><span class="token number">1</span> <span class="token string">" "</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-endcomp">endcomp</span><span class="token punctuation">;</span>
        <span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
    <span class="token step keyword">run</span><span class="token punctuation">;</span>
<span class="token macro-keyword keyword">%end</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> rtf <span class="token keyword keyword-close">close</span><span class="token punctuation">;</span>
<span class="token keyword keyword-ods">ods</span> listing<span class="token punctuation">;</span>
</code></pre><h2 id="proc-transpose过程"><code>proc transpose</code>过程 </h2>
<h3 id="过程步选项说明">过程步选项说明 </h3>
<ul>
<li><code>out=</code> 转置后的sas数据集，省略时sas系统产生一个名子为datan的数据集。</li>
<li><code>prefix=</code> 规定转置后数据集变量名的前缀。</li>
<li><code>name=</code> 规定转置后数据集中的一个变量名（指的是<code>var</code>中的变量），省略时该变量名为<code>_name_</code>。</li>
<li><code>label=</code> 规定转置后变量的标签，省略该选项，且原数据集中至少有一个要转置的变量有标签时，该变量标签为<code>_label_</code>。</li>
<li><code>let</code> 允许id变量出现相同的值。by组内最后一个id值的观测被转置。</li>
</ul>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc transpose</span> <span class="token proc-args">&lt;<span class="token arg keyword">data</span><span class="token operator">=</span><span class="token arg-value">in</span>-<span class="token arg keyword">dataset</span>&gt; &lt;<span class="token arg keyword">label</span><span class="token operator">=</span><span class="token arg-value">label</span>&gt; &lt;<span class="token arg keyword">let</span>&gt;
&lt;<span class="token arg keyword">name</span><span class="token operator">=</span><span class="token arg-value">name</span>&gt; &lt;<span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">out</span>-<span class="token arg keyword">dataset</span>&gt; &lt;<span class="token arg keyword">prefix</span><span class="token operator">=</span><span class="token arg-value">prefix</span>&gt;<span class="token punctuation">;</span></span>
    <span class="token keyword keyword-by">by</span> <span class="token operator">&lt;</span>descending<span class="token operator">&gt;</span> variable<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>descending<span class="token operator">&gt;</span> variable<span class="token operator">-</span>n<span class="token operator">&gt;</span> <span class="token punctuation">;</span>
    copy <span class="token function keyword">variables</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    id variable<span class="token punctuation">;</span>
    idlabel variable<span class="token punctuation">;</span>
    <span class="token keyword keyword-var">var</span> <span class="token function keyword">variable</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><h3 id="byidvaridlabel语句"><code>by</code>/<code>id</code>/<code>var</code>/<code>idlabel</code>语句 </h3>
<ol>
<li><code>by</code>语句
<ul>
<li>规定对每个<code>by</code>组求转置，<code>by</code>变量包含在输出数据集中但没有被转置。</li>
<li>省略<code>by</code>语句时，对全部观测进行转置。</li>
</ul>
</li>
<li><code>var</code>语句
<ul>
<li><code>var</code>语句列出要转置的变量。</li>
<li>省略<code>var</code>语句时，则没有列在其它语句里的所有数值变量被转置。</li>
</ul>
</li>
<li><code>id</code>语句
<ul>
<li><code>id</code>语句规定输入数据集中1个变量的值为转置后数据集的变量名。</li>
<li>在没有选项<code>let</code>时，<code>id</code>变量的值在数据集中只能出现一次，使用<code>by</code>语句，<code>by</code>组内只包含最后的<code>id</code>值。</li>
<li>省略<code>id</code>语句时，以<code>col1, col2,…</code>作为转置后的变量名。</li>
</ul>
</li>
<li><code>idlabel</code>语句
<ul>
<li>为转置后的变量创建标签。</li>
</ul>
</li>
</ol>
<h2 id="proc-import过程"><code>proc import</code>过程 </h2>
<h3 id="常用选项介绍">常用选项介绍 </h3>
<pre data-role="codeBlock" data-info="sas" class="language-sas sas"><code><span class="token step keyword">proc import</span>
    <span class="token proc-args"><span class="token arg keyword">datafile</span><span class="token operator">=</span><span class="token string">"filename"</span> | <span class="token arg keyword">datatable</span><span class="token operator">=</span><span class="token string">"tablename"</span> <span class="token punctuation">(</span><span class="token arg keyword">not</span> <span class="token arg keyword">used</span> <span class="token arg keyword">for</span> <span class="token arg keyword">microsoft</span> <span class="token arg keyword">excel</span> <span class="token arg keyword">files</span><span class="token punctuation">)</span>
    &lt;<span class="token arg keyword">dbms</span><span class="token operator">=</span><span class="token arg-value">data</span>-<span class="token arg keyword">source</span>-<span class="token arg keyword">identifier</span>&gt;
    &lt;<span class="token arg keyword">out</span><span class="token operator">=</span><span class="token arg-value">libref.sas</span> <span class="token arg keyword">data</span>-<span class="token arg keyword">set</span>-<span class="token arg keyword">name</span>&gt; &lt;<span class="token arg keyword">sas</span> <span class="token arg keyword">data</span>-<span class="token arg keyword">set</span>-<span class="token function keyword">option</span><span class="token punctuation">(</span><span class="token arg keyword">s</span><span class="token punctuation">)</span>&gt;
    &lt;<span class="token arg keyword">replace</span><span class="token punctuation">;</span></span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>file<span class="token operator">-</span>format<span class="token operator">-</span>specific<span class="token operator">-</span>statements<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token step keyword">run</span><span class="token punctuation">;</span>
</code></pre><ul>
<li><code>datafile</code>|<code>datatable</code>：读取的数据地址，唯一的必填选项。<code>datafile</code>可以用别名file代替，<code>datatable</code>可以用别名table代替。</li>
<li><code>out=</code>：输出数据集名。</li>
<li><code>replace</code>：如果数据集已经存在，是否替换。</li>
<li><code>delimiter=</code>：
<ul>
<li>用于指定文件的分隔符；如果不指定，默认的分割符为空格。</li>
<li>csv即逗号分割值的文件：指定<code>dbms=dlm</code>, <code>delimiter=','</code> ；也可以直接指定<code>dbms=csv</code>。</li>
</ul>
</li>
<li><code>dbms=</code> 导入的数据的类型，参考如下标识符。</li>
</ul>
<table>
<thead>
<tr>
<th>标识符</th>
<th>源数据格式</th>
<th>文件扩展名</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CSV</code></td>
<td>Delimited file (comma-separated values)</td>
<td>.csv</td>
</tr>
<tr>
<td><code>DLM</code></td>
<td>Delimited file (default delimiter is a blank)</td>
<td>.dat or .txt</td>
</tr>
<tr>
<td><code>JMP</code></td>
<td>JMP files, Version 7 or later format</td>
<td>.jmp</td>
</tr>
<tr>
<td><code>TAB</code></td>
<td>Delimited file (tab-delimited values)</td>
<td>.txt</td>
</tr>
<tr>
<td><code>EXCEL</code></td>
<td>Microsoft Excel 97, 2000, 2002, 2003, or 2007 spreadsheet using the LIBNAME statement.</td>
<td>.xls .xlsb .xlsm .xlsx</td>
</tr>
<tr>
<td><code>XLS</code></td>
<td>Microsoft Excel 5.0, 95, 97, 2000, 2002, or 2003 spreadsheet using file formats</td>
<td>.xls</td>
</tr>
<tr>
<td><code>ACCESS</code></td>
<td>Microsoft Access 2000, 2002, 2003, or 2007 table using the LIBNAME statement.</td>
<td>.mdb .accdb</td>
</tr>
<tr>
<td><code>DTA</code></td>
<td>Stata file</td>
<td>.dta</td>
</tr>
<tr>
<td><code>EXCEL 4</code> <code>EXCEL 5</code></td>
<td>Microsoft Excel 4.0, Excel 5.0 or 7.0 (95) spreadsheet.</td>
<td>.xls</td>
</tr>
<tr>
<td><code>EXCELCS</code></td>
<td>Microsoft Excel spreadsheet connecting remotely through PC Files Server.</td>
<td>.xls  .xlsb</td>
</tr>
<tr>
<td><code>SAV</code></td>
<td>SPSS file</td>
<td>.sav</td>
</tr>
<tr>
<td><code>TAB</code></td>
<td>Delimited file (tab-delimited values)</td>
<td>.txt</td>
</tr>
</tbody>
</table>
<h3 id="proc-import常用语句"><code>proc import</code>常用语句 </h3>
<ul>
<li><code>getnames=yes|no;</code>语句：对于Excel文档，以第一行为变量名。</li>
<li><code>sheet=sheet-name;</code>语句：对于Excel文档，指定文档中sheet的名字。</li>
<li><code>range = '$A1:H10';</code>语句：若只读取工作表的一部分范围。</li>
<li><code>mixed=yes|no;</code>语句：若同时有字符和数值型，不将数值型转换为缺失值而是处理为字符型; 使用mixed之后，日期也会被当作字符处理。</li>
<li><code>datarow=n;</code>语句：指定开始读取的行号，从第几行开始读取数据。</li>
</ul>

      </div>
      <div class="md-sidebar-toc">
<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#sas-programmer-101" class="md-toc-link"><p>SAS-Programmer-101</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#数据集选项执行顺序" class="md-toc-link"><p>数据集选项执行顺序</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#选项执行顺序" class="md-toc-link">
            <p>选项执行顺序</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#常见数据集选项" class="md-toc-link">
            <p>常见数据集选项</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#sas-eg设置自动查log的方法" class="md-toc-link">
            <p>SAS EG设置自动查log的方法</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#处理特殊字符与输出特殊符号" class="md-toc-link"><p>处理特殊字符与输出特殊符号</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#上下标supersub" class="md-toc-link">
            <p>上/下标：<code>super</code>/<code>sub</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#含特殊意义的字符raw" class="md-toc-link">
            <p>含特殊意义的字符：<code>raw</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#其他特殊字符unicode" class="md-toc-link">
            <p>其他特殊字符：<code>unicode</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用unicode删除特殊字符" class="md-toc-link">
            <p>使用unicode删除特殊字符</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#有用的系统选项" class="md-toc-link"><p>有用的系统选项</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#修改变量名命名规则" class="md-toc-link">
            <p>修改变量名命名规则</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#宏里面使用in语句的系统选项" class="md-toc-link">
            <p>宏里面使用<code>in</code>语句的系统选项</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#解决footnote太长的warning" class="md-toc-link">
            <p>解决footnote太长的warning</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#sas数据集逻辑库excel的交互" class="md-toc-link"><p>sas数据集/逻辑库/excel的交互</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#sas数据集导出到excel" class="md-toc-link"><p>sas数据集导出到excel</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用ods-excel" class="md-toc-link">
            <p>使用<code>ods excel</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用ods-导出带有template的excel" class="md-toc-link">
            <p>使用<code>ods</code> 导出带有template的excel</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用proc-export" class="md-toc-link">
            <p>使用<code>proc export</code></p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#excel导入为sas数据集" class="md-toc-link"><p>excel导入为sas数据集</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用proc-import" class="md-toc-link">
            <p>使用<code>proc import</code></p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#删除宏变量的额外空格" class="md-toc-link"><p>删除宏变量的额外空格</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#方法separated-by-" class="md-toc-link">
            <p>方法：<code>separated by ''</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#方法trimmed" class="md-toc-link">
            <p>方法：<code>trimmed</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#方法let" class="md-toc-link">
            <p>方法：<code>%let</code></p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#掩码宏函数" class="md-toc-link"><p>掩码宏函数</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#str与nrstr" class="md-toc-link">
            <p><code>%str</code>与<code>%nrstr</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#quote和nrquote" class="md-toc-link">
            <p><code>%quote</code>和<code>%nrquote</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#bquote和nrbquote" class="md-toc-link">
            <p><code>%bquote</code>和<code>%nrbquote</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#superq" class="md-toc-link">
            <p><code>%superq</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#unquote" class="md-toc-link">
            <p><code>%unquote</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#具有掩码作用的宏函数" class="md-toc-link">
            <p>具有掩码作用的宏函数</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#attrib语句" class="md-toc-link">
            <p><code>attrib</code>语句</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#正则表达式" class="md-toc-link"><p>正则表达式</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#模式匹配" class="md-toc-link">
            <p>模式匹配</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#基本语法" class="md-toc-link"><p>基本语法</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#正则表达式的构成" class="md-toc-link">
            <p>正则表达式的构成</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#reg基本语法" class="md-toc-link">
            <p>reg基本语法</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#sas中的基本函数" class="md-toc-link">
            <p>SAS中的基本函数</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#一般元字符" class="md-toc-link">
            <p>一般元字符</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#元字符分组" class="md-toc-link">
            <p>元字符分组</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#前向搜索和后向搜索断言" class="md-toc-link">
            <p>前向搜索和后向搜索【断言】</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#注释和内联修饰符" class="md-toc-link">
            <p>注释和内联修饰符</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#表达式的组合" class="md-toc-link">
            <p>表达式的组合</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#常用正则" class="md-toc-link">
            <p>常用正则</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#length语句" class="md-toc-link"><p><code>length</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用说明" class="md-toc-link">
            <p>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#注意事项" class="md-toc-link">
            <p>注意事项</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#retain语句" class="md-toc-link"><p><code>retain</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#retain使用说明" class="md-toc-link">
            <p><code>retain</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#retain注意事项" class="md-toc-link">
            <p><code>retain</code>注意事项</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用retain前向填充缺失值" class="md-toc-link">
            <p>案例：使用<code>retain</code>前向填充缺失值</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用retain给数据加序号" class="md-toc-link">
            <p>案例：使用<code>retain</code>给数据加序号</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例set语句自动retain变量" class="md-toc-link">
            <p>案例：<code>set</code>语句自动<code>retain</code>变量</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#set语句" class="md-toc-link"><p><code>set</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#set使用说明" class="md-toc-link">
            <p><code>set</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#一个set语句中多个数据集" class="md-toc-link">
            <p>一个<code>set</code>语句中多个数据集</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#多个set语句中一个数据集" class="md-toc-link">
            <p>多个<code>set</code>语句中一个数据集</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#选项pointvariable" class="md-toc-link">
            <p>选项：<code>point=Variable</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#选项nobsvariable" class="md-toc-link">
            <p>选项：<code>nobs=Variable</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#选项endvariable" class="md-toc-link">
            <p>选项：<code>end=Variable</code></p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#merge语句" class="md-toc-link"><p><code>merge</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#没有by语句的merge" class="md-toc-link">
            <p>没有<code>by</code>语句的<code>merge</code></p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用by语句的merge" class="md-toc-link">
            <p>使用<code>by</code>语句的<code>merge</code></p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#多表查询" class="md-toc-link"><p>多表查询</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#笛卡尔积两个表所有可能的" class="md-toc-link">
            <p>笛卡尔积：两个表所有可能的</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#内联接两个表共有的数据" class="md-toc-link">
            <p>内联接：两个表共有的数据</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#左连接匹配后保留左表所有数据左表顺序保持不变" class="md-toc-link">
            <p>左连接：匹配后保留左表所有数据，左表顺序保持不变</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#左连接只保留左表独有的数据" class="md-toc-link">
            <p>左连接：只保留左表独有的数据</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#右连接匹配后保留右表所有数据右表顺序保持不变" class="md-toc-link">
            <p>右连接：匹配后保留右表所有数据，右表顺序保持不变</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#右连接只保留右表独有的数据" class="md-toc-link">
            <p>右连接：只保留右表独有的数据</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#全连接两个表的匹配数据及未匹配的数据" class="md-toc-link">
            <p>全连接：两个表的匹配数据及未匹配的数据</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#全连接两个表各自的独有数据" class="md-toc-link">
            <p>全连接：两个表各自的独有数据</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#array语句" class="md-toc-link"><p><code>array</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#array使用说明" class="md-toc-link">
            <p><code>array</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#通过下标引用数组元素" class="md-toc-link">
            <p>通过下标引用数组元素</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用do循环遍历数组元素" class="md-toc-link">
            <p>使用<code>do</code>循环遍历数组元素</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用of运算符处理所有元素" class="md-toc-link">
            <p>使用<code>of</code>运算符处理所有元素</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#in运算符访问数组元素的值" class="md-toc-link">
            <p><code>in</code>运算符访问数组元素的值</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#不同数组间的判断" class="md-toc-link">
            <p>不同数组间的判断</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#select-when语句" class="md-toc-link"><p><code>select-when</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#select-when使用说明" class="md-toc-link">
            <p><code>select-when</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例-简单的单变量判断" class="md-toc-link">
            <p>案例: 简单的单变量判断</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例-使用do-end执行复杂语句组" class="md-toc-link">
            <p>案例: 使用<code>do-end</code>执行复杂语句组</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例-在when中使用复合表达式" class="md-toc-link">
            <p>案例: 在<code>when</code>中使用复合表达式</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#continue与leave语句" class="md-toc-link"><p><code>continue</code>与<code>leave</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#continue与leave使用说明" class="md-toc-link">
            <p><code>continue</code>与<code>leave</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用continue跳过当前循环" class="md-toc-link">
            <p>案例：使用<code>continue</code>跳过当前循环</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用leave跳出整个循环" class="md-toc-link">
            <p>案例：使用leave跳出整个循环</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#link与goto语句" class="md-toc-link"><p><code>link</code>与<code>goto</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#link与goto使用说明" class="md-toc-link">
            <p><code>link</code>与<code>goto</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用goto转到指定语句" class="md-toc-link">
            <p>案例：使用<code>goto</code>转到指定语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用带return语句的link" class="md-toc-link">
            <p>案例：使用带return语句的<code>link</code></p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#output与return语句" class="md-toc-link"><p><code>output</code>与<code>return</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#output与return使用说明" class="md-toc-link">
            <p><code>output</code>与<code>return</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用return停止后续语句" class="md-toc-link">
            <p>案例：使用<code>return</code>停止后续语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#案例使用将不同的观测数据输出到同一行" class="md-toc-link">
            <p>案例：使用将不同的观测数据输出到同一行</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#proc-sort过程" class="md-toc-link"><p><code>proc sort</code>过程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#proc-sort使用说明" class="md-toc-link">
            <p><code>proc sort</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#只保留没有重复的观测" class="md-toc-link">
            <p>只保留没有重复的观测</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#对数据集进行去重" class="md-toc-link">
            <p>对数据集进行去重</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#获取数据集中重复的观测" class="md-toc-link">
            <p>获取数据集中重复的观测</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用key语句对整体变量设置倒序" class="md-toc-link">
            <p>使用<code>key</code>语句对整体变量设置倒序</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#proc-format过程" class="md-toc-link"><p><code>proc format</code>过程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#proc-format使用说明" class="md-toc-link">
            <p><code>proc format</code>使用说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#设置format的范围值" class="md-toc-link">
            <p>设置format的范围值</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用defaultn选项处理format截断" class="md-toc-link">
            <p>使用<code>(default=n)</code>选项处理format截断</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#使用fuzzn选项设置模糊format" class="md-toc-link">
            <p>使用<code>(fuzz=.n)</code>选项设置模糊format</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#定义picure的数值模板" class="md-toc-link">
            <p>定义<code>picure</code>的数值模板</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#对picture数值模板保留小数" class="md-toc-link">
            <p>对<code>picture</code>数值模板保留小数</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#定义描述统计的输出模板" class="md-toc-link">
            <p>定义描述统计的输出模板</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#picuture进行round的bug处理" class="md-toc-link">
            <p><code>picuture</code>进行<code>round</code>的Bug处理</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#format与数据集的传输" class="md-toc-link"><p><code>format</code>与数据集的传输</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#数据集转为format" class="md-toc-link">
            <p>数据集转为<code>format</code></p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#format转为数据集" class="md-toc-link"><p><code>format</code>转为数据集</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#常规format转为数据集" class="md-toc-link">
            <p>常规<code>format</code>转为数据集</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#带有端点值和无限范围的format转为数据集" class="md-toc-link">
            <p>带有端点值和无限范围的<code>format</code>转为数据集</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#proc-report过程" class="md-toc-link"><p><code>proc report</code>过程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#基本语句" class="md-toc-link">
            <p>基本语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ods语句相关说明" class="md-toc-link">
            <p><code>ods</code>语句相关说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#过程步options" class="md-toc-link">
            <p>过程步options</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#column语句" class="md-toc-link"><p><code>column</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#基本原则" class="md-toc-link">
            <p>基本原则</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#多层表头" class="md-toc-link">
            <p>多层表头</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#where语句" class="md-toc-link">
            <p><code>where</code>语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#define语句" class="md-toc-link">
            <p><code>define</code>语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#by语句" class="md-toc-link">
            <p><code>by</code>语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#byvar的使用" class="md-toc-link">
            <p><code>#byvar</code>的使用</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#break与rbreak语句" class="md-toc-link">
            <p><code>break</code>与<code>rbreak</code>语句</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#compute语句" class="md-toc-link"><p><code>compute</code>语句</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#line语句" class="md-toc-link">
            <p><code>line</code>语句</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#call-define语句" class="md-toc-link">
            <p><code>call define</code>语句</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#footnote显示在第一页" class="md-toc-link">
            <p>footnote显示在第一页</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#proc-transpose过程" class="md-toc-link"><p><code>proc transpose</code>过程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#过程步选项说明" class="md-toc-link">
            <p>过程步选项说明</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#byidvaridlabel语句" class="md-toc-link">
            <p><code>by</code>/<code>id</code>/<code>var</code>/<code>idlabel</code>语句</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#proc-import过程" class="md-toc-link"><p><code>proc import</code>过程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#常用选项介绍" class="md-toc-link">
            <p>常用选项介绍</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#proc-import常用语句" class="md-toc-link">
            <p><code>proc import</code>常用语句</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
</div>
      <a id="sidebar-toc-btn">≡</a>
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>